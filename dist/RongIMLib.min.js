var Polling={SearchMpInput:function(){var a={};this.setType=function(b){a.type=b},this.setId=function(b){a.id=b},this.toArrayBuffer=function(){return a}},SearchMpOutput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.setInfo=function(b){a.info=b},this.toArrayBuffer=function(){return a}},MpInfo:function(){var a={};this.setMpid=function(b){a.mpid=b},this.setName=function(b){a.name=b},this.setType=function(b){a.type=b},this.setTime=function(b){a.time=b},this.setPortraitUri=function(b){a.portraitUrl=b},this.setExtra=function(b){a.extra=b},this.toArrayBuffer=function(){return a}},PullMpInput:function(){var a={};this.setMpid=function(b){a.mpid=b},this.setTime=function(b){a.time=b},this.toArrayBuffer=function(){return a}},PullMpOutput:function(){var a={};this.setStatus=function(b){a.status=b},this.setInfo=function(b){a.info=b},this.toArrayBuffer=function(){return a}},MPFollowInput:function(){var a={};this.setId=function(b){a.id=b},this.toArrayBuffer=function(){return a}},MPFollowOutput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.setInfo=function(b){a.info=b},this.toArrayBuffer=function(){return a}},NotifyMsg:function(){var a={};this.setType=function(b){a.type=b},this.setTime=function(b){a.time=b},this.toArrayBuffer=function(){return a}},SyncRequestMsg:function(){var a={};this.setSyncTime=function(b){a.syncTime=b||0},this.setIspolling=function(b){a.ispolling=!!b},this.setIsweb=function(b){a.isweb=!!b},this.setIsPullSend=function(b){a.isPullSend=!!b},this.toArrayBuffer=function(){return a}},UpStreamMessage:function(){var a={};this.setSessionId=function(b){a.sessionId=b},this.setClassname=function(b){a.classname=b},this.setContent=function(b){b&&(a.content=b)},this.setPushText=function(b){a.pushText=b},this.toArrayBuffer=function(){return a}},DownStreamMessages:function(){var a={};this.setList=function(b){a.list=b},this.setSyncTime=function(b){a.syncTime=b},this.toArrayBuffer=function(){return a}},DownStreamMessage:function(){var a={};this.setFromUserId=function(b){a.fromUserId=b},this.setType=function(b){a.type=b},this.setGroupId=function(b){a.groupId=b},this.setClassname=function(b){a.classname=b},this.setContent=function(b){b&&(a.content=b)},this.setDataTime=function(b){a.dataTime=b},this.setStatus=function(b){a.status=b},this.setMsgId=function(b){a.msgId=b},this.toArrayBuffer=function(){return a}},CreateDiscussionInput:function(){var a={};this.setName=function(b){a.name=b},this.toArrayBuffer=function(){return a}},CreateDiscussionOutput:function(){var a={};this.setId=function(b){a.id=b},this.toArrayBuffer=function(){return a}},ChannelInvitationInput:function(){var a={};this.setUsers=function(b){a.users=b},this.toArrayBuffer=function(){return a}},LeaveChannelInput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.toArrayBuffer=function(){return a}},ChannelEvictionInput:function(){var a={};this.setUser=function(b){a.user=b},this.toArrayBuffer=function(){return a}},RenameChannelInput:function(){var a={};this.setName=function(b){a.name=b},this.toArrayBuffer=function(){return a}},ChannelInfoInput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.toArrayBuffer=function(){return a}},ChannelInfoOutput:function(){var a={};this.setType=function(b){a.type=b},this.setChannelId=function(b){a.channelId=b},this.setChannelName=function(b){a.channelName=b},this.setAdminUserId=function(b){a.adminUserId=b},this.setFirstTenUserIds=function(b){a.firstTenUserIds=b},this.setOpenStatus=function(b){a.openStatus=b},this.toArrayBuffer=function(){return a}},ChannelInfosInput:function(){var a={};this.setPage=function(b){a.page=b},this.setNumber=function(b){a.number=b},this.toArrayBuffer=function(){return a}},ChannelInfosOutput:function(){var a={};this.setChannels=function(b){a.channels=b},this.setTotal=function(b){a.total=b},this.toArrayBuffer=function(){return a}},MemberInfo:function(){var a={};this.setUserId=function(b){a.userId=b},this.setUserName=function(b){a.userName=b},this.setUserPortrait=function(b){a.userPortrait=b},this.setExtension=function(b){a.extension=b},this.toArrayBuffer=function(){return a}},GroupMembersInput:function(){var a={};this.setPage=function(b){a.page=b},this.setNumber=function(b){a.number=b},this.toArrayBuffer=function(){return a}},GroupMembersOutput:function(){var a={};this.setMembers=function(b){a.members=b},this.setTotal=function(b){a.total=b},this.toArrayBuffer=function(){return a}},GetUserInfoInput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.toArrayBuffer=function(){return a}},GetUserInfoOutput:function(){var a={};this.setUserId=function(b){a.userId=b},this.setUserName=function(b){a.userName=b},this.setUserPortrait=function(b){a.userPortrait=b},this.toArrayBuffer=function(){return a}},GetSessionIdInput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.toArrayBuffer=function(){return a}},GetSessionIdOutput:function(){var a={};this.setSessionId=function(b){a.sessionId=b},this.toArrayBuffer=function(){return a}},GetQNupTokenInput:function(){var a={};this.setType=function(b){a.type=b},this.toArrayBuffer=function(){return a}},GetQNupTokenOutput:function(){var a={};this.setDeadline=function(b){a.deadline=b},this.setToken=function(b){a.token=b},this.toArrayBuffer=function(){return a}},GetQNdownloadUrlInput:function(){var a={};this.setType=function(b){a.type=b},this.setKey=function(b){a.key=b},this.toArrayBuffer=function(){return a}},GetQNdownloadUrlOutput:function(){var a={};this.setDownloadUrl=function(b){a.downloadUrl=b},this.toArrayBuffer=function(){return a}},Add2BlackListInput:function(){var a={};this.setUserId=function(b){a.userId=b},this.toArrayBuffer=function(){return a}},RemoveFromBlackListInput:function(){var a={};this.setUserId=function(b){a.userId=b},this.toArrayBuffer=function(){return a}},QueryBlackListInput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.toArrayBuffer=function(){return a}},QueryBlackListOutput:function(){var a={};this.setUserIds=function(b){a.userIds=b},this.toArrayBuffer=function(){return a}},BlackListStatusInput:function(){var a={};this.setUserId=function(b){a.userId=b},this.toArrayBuffer=function(){return a}},BlockPushInput:function(){var a={};this.setBlockeeId=function(b){a.blockeeId=b},this.toArrayBuffer=function(){return a}},ModifyPermissionInput:function(){var a={};this.setOpenStatus=function(b){a.openStatus=b},this.toArrayBuffer=function(){return a}},GroupInput:function(){var a={};this.setGroupInfo=function(b){for(var c=0,d=[];c<b.length;c++)d.push({id:b[c].getContent().id,name:b[c].getContent().name});a.groupInfo=d},this.toArrayBuffer=function(){return a}},GroupOutput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.toArrayBuffer=function(){return a}},GroupInfo:function(){var a={};this.setId=function(b){a.id=b},this.setName=function(b){a.name=b},this.getContent=function(){return a},this.toArrayBuffer=function(){return a}},GroupHashInput:function(){var a={};this.setUserId=function(b){a.userId=b},this.setGroupHashCode=function(b){a.groupHashCode=b},this.toArrayBuffer=function(){return a}},GroupHashOutput:function(){var a={};this.setResult=function(b){a.result=b},this.toArrayBuffer=function(){return a}},ChrmInput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.toArrayBuffer=function(){return a}},ChrmOutput:function(){var a={};this.setNothing=function(b){a.nothing=b},this.toArrayBuffer=function(){return a}},ChrmPullMsg:function(){var a={};this.setSyncTime=function(b){a.syncTime=b},this.setCount=function(b){a.count=b},this.toArrayBuffer=function(){return a}},RelationsInput:function(){var a={};this.setType=function(b){a.type=b},this.setMsg=function(b){a.msg=b},this.toArrayBuffer=function(){return a}},RelationsOutput:function(){var a={};this.setInfo=function(b){a.info=b},this.toArrayBuffer=function(){return a}},RelationInfo:function(){var a={};this.setType=function(b){a.type=b},this.setUserId=function(b){a.userId=b},this.setMsg=function(b){a.msg=b},this.toArrayBuffer=function(){return a}},HistoryMessageInput:function(){var a={};this.setTargetId=function(b){a.targetId=b},this.setDataTime=function(b){a.dataTime=b},this.setSize=function(b){a.size=b},this.toArrayBuffer=function(){return a}},HistoryMessagesOuput:function(){var a={};this.setList=function(b){a.list=b},this.setSyncTime=function(b){a.syncTime=b},this.setHasMsg=function(b){a.hasMsg=b},this.toArrayBuffer=function(){return a}}};for(var f in Polling)Polling[f].decode=function(b){var back={},val=JSON.parse(b)||eval("("+b+")");for(var i in val)back[i]=val[i],back["get"+i.charAt(0).toUpperCase()+i.slice(1)]=function(){return val[i]};return back};!function(a){"use strict";function b(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function c(a,b){return a<<b|a>>>32-b}function d(a,d,e,f,g,h){return b(c(b(b(d,a),b(f,h)),g),e)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,c){a[c>>5]|=128<<c%32,a[(c+64>>>9<<4)+14]=c;var d,i,j,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(d=0;d<a.length;d+=16)i=m,j=n,k=o,l=p,m=e(m,n,o,p,a[d],7,-680876936),p=e(p,m,n,o,a[d+1],12,-389564586),o=e(o,p,m,n,a[d+2],17,606105819),n=e(n,o,p,m,a[d+3],22,-1044525330),m=e(m,n,o,p,a[d+4],7,-176418897),p=e(p,m,n,o,a[d+5],12,1200080426),o=e(o,p,m,n,a[d+6],17,-1473231341),n=e(n,o,p,m,a[d+7],22,-45705983),m=e(m,n,o,p,a[d+8],7,1770035416),p=e(p,m,n,o,a[d+9],12,-1958414417),o=e(o,p,m,n,a[d+10],17,-42063),n=e(n,o,p,m,a[d+11],22,-1990404162),m=e(m,n,o,p,a[d+12],7,1804603682),p=e(p,m,n,o,a[d+13],12,-40341101),o=e(o,p,m,n,a[d+14],17,-1502002290),n=e(n,o,p,m,a[d+15],22,1236535329),m=f(m,n,o,p,a[d+1],5,-165796510),p=f(p,m,n,o,a[d+6],9,-1069501632),o=f(o,p,m,n,a[d+11],14,643717713),n=f(n,o,p,m,a[d],20,-373897302),m=f(m,n,o,p,a[d+5],5,-701558691),p=f(p,m,n,o,a[d+10],9,38016083),o=f(o,p,m,n,a[d+15],14,-660478335),n=f(n,o,p,m,a[d+4],20,-405537848),m=f(m,n,o,p,a[d+9],5,568446438),p=f(p,m,n,o,a[d+14],9,-1019803690),o=f(o,p,m,n,a[d+3],14,-187363961),n=f(n,o,p,m,a[d+8],20,1163531501),m=f(m,n,o,p,a[d+13],5,-1444681467),p=f(p,m,n,o,a[d+2],9,-51403784),o=f(o,p,m,n,a[d+7],14,1735328473),n=f(n,o,p,m,a[d+12],20,-1926607734),m=g(m,n,o,p,a[d+5],4,-378558),p=g(p,m,n,o,a[d+8],11,-2022574463),o=g(o,p,m,n,a[d+11],16,1839030562),n=g(n,o,p,m,a[d+14],23,-35309556),m=g(m,n,o,p,a[d+1],4,-1530992060),p=g(p,m,n,o,a[d+4],11,1272893353),o=g(o,p,m,n,a[d+7],16,-155497632),n=g(n,o,p,m,a[d+10],23,-1094730640),m=g(m,n,o,p,a[d+13],4,681279174),p=g(p,m,n,o,a[d],11,-358537222),o=g(o,p,m,n,a[d+3],16,-722521979),n=g(n,o,p,m,a[d+6],23,76029189),m=g(m,n,o,p,a[d+9],4,-640364487),p=g(p,m,n,o,a[d+12],11,-421815835),o=g(o,p,m,n,a[d+15],16,530742520),n=g(n,o,p,m,a[d+2],23,-995338651),m=h(m,n,o,p,a[d],6,-198630844),p=h(p,m,n,o,a[d+7],10,1126891415),o=h(o,p,m,n,a[d+14],15,-1416354905),n=h(n,o,p,m,a[d+5],21,-57434055),m=h(m,n,o,p,a[d+12],6,1700485571),p=h(p,m,n,o,a[d+3],10,-1894986606),o=h(o,p,m,n,a[d+10],15,-1051523),n=h(n,o,p,m,a[d+1],21,-2054922799),m=h(m,n,o,p,a[d+8],6,1873313359),p=h(p,m,n,o,a[d+15],10,-30611744),o=h(o,p,m,n,a[d+6],15,-1560198380),n=h(n,o,p,m,a[d+13],21,1309151649),m=h(m,n,o,p,a[d+4],6,-145523070),p=h(p,m,n,o,a[d+11],10,-1120210379),o=h(o,p,m,n,a[d+2],15,718787259),n=h(n,o,p,m,a[d+9],21,-343485551),m=b(m,i),n=b(n,j),o=b(o,k),p=b(p,l);return[m,n,o,p]}function j(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function k(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c}function l(a){return j(i(k(a),8*a.length))}function m(a,b){var c,d,e=k(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=i(e,8*a.length)),c=0;16>c;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=i(f.concat(k(b)),512+8*b.length),j(i(g.concat(d),640))}function n(a){var b,c,d="0123456789abcdef",e="";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(b>>>4&15)+d.charAt(15&b);return e}function o(a){return unescape(encodeURIComponent(a))}function p(a){return l(o(a))}function q(a){return n(p(a))}function r(a,b){return m(o(a),o(b))}function s(a,b){return n(r(a,b))}function t(a,b,c){return b?c?r(b,a):s(b,a):c?p(a):q(a)}a.md5=t,"function"==typeof define&&define.amd?define("md5",function(){return t}):"object"==typeof module&&module.exports?module.exports=t:a.md5=t}(this);var RongIMLib;!function(a){!function(a){a[a.IN_BLACK_LIST=0]="IN_BLACK_LIST",a[a.NOT_IN_BLACK_LIST=1]="NOT_IN_BLACK_LIST"}(a.BlacklistStatus||(a.BlacklistStatus={}));a.BlacklistStatus;!function(a){a[a.XHR_POLLING=0]="XHR_POLLING",a[a.WEBSOCKET=1]="WEBSOCKET",a[a.HTTP=0]="HTTP",a[a.HTTPS=1]="HTTPS"}(a.ConnectionChannel||(a.ConnectionChannel={}));a.ConnectionChannel;!function(a){a[a.CONNECTED=0]="CONNECTED",a[a.CONNECTING=1]="CONNECTING",a[a.DISCONNECTED=2]="DISCONNECTED",a[a.KICKED_OFFLINE_BY_OTHER_CLIENT=6]="KICKED_OFFLINE_BY_OTHER_CLIENT",a[a.NETWORK_UNAVAILABLE=-1]="NETWORK_UNAVAILABLE"}(a.ConnectionStatus||(a.ConnectionStatus={}));a.ConnectionStatus;!function(a){a[a.DO_NOT_DISTURB=0]="DO_NOT_DISTURB",a[a.NOTIFY=1]="NOTIFY"}(a.ConversationNotificationStatus||(a.ConversationNotificationStatus={}));a.ConversationNotificationStatus;!function(a){a[a.NONE=0]="NONE",a[a.PRIVATE=1]="PRIVATE",a[a.DISCUSSION=2]="DISCUSSION",a[a.GROUP=3]="GROUP",a[a.CHATROOM=4]="CHATROOM",a[a.CUSTOMER_SERVICE=5]="CUSTOMER_SERVICE",a[a.SYSTEM=6]="SYSTEM",a[a.APP_PUBLIC_SERVICE=7]="APP_PUBLIC_SERVICE",a[a.PUBLIC_SERVICE=8]="PUBLIC_SERVICE"}(a.ConversationType||(a.ConversationType={}));a.ConversationType;!function(a){a[a.OPENED=0]="OPENED",a[a.CLOSED=1]="CLOSED"}(a.DiscussionInviteStatus||(a.DiscussionInviteStatus={}));a.DiscussionInviteStatus;!function(a){a[a.TIMEOUT=-1]="TIMEOUT",a[a.UNKNOWN=-2]="UNKNOWN",a[a.SEND_FREQUENCY_TOO_FAST=20604]="SEND_FREQUENCY_TOO_FAST",a[a.NOT_IN_DISCUSSION=21406]="NOT_IN_DISCUSSION",a[a.JOIN_IN_DISCUSSION=21407]="JOIN_IN_DISCUSSION",a[a.CREATE_DISCUSSION=21408]="CREATE_DISCUSSION",a[a.INVITE_DICUSSION=21409]="INVITE_DICUSSION",a[a.NOT_IN_GROUP=22406]="NOT_IN_GROUP",a[a.NOT_IN_CHATROOM=23406]="NOT_IN_CHATROOM",a[a.GET_USERINFO_ERROR=23407]="GET_USERINFO_ERROR",a[a.REJECTED_BY_BLACKLIST=405]="REJECTED_BY_BLACKLIST",a[a.RC_NET_CHANNEL_INVALID=30001]="RC_NET_CHANNEL_INVALID",a[a.RC_NET_UNAVAILABLE=30002]="RC_NET_UNAVAILABLE",a[a.RC_MSG_RESP_TIMEOUT=30003]="RC_MSG_RESP_TIMEOUT",a[a.RC_HTTP_SEND_FAIL=30004]="RC_HTTP_SEND_FAIL",a[a.RC_HTTP_REQ_TIMEOUT=30005]="RC_HTTP_REQ_TIMEOUT",a[a.RC_HTTP_RECV_FAIL=30006]="RC_HTTP_RECV_FAIL",a[a.RC_NAVI_RESOURCE_ERROR=30007]="RC_NAVI_RESOURCE_ERROR",a[a.RC_NODE_NOT_FOUND=30008]="RC_NODE_NOT_FOUND",a[a.RC_DOMAIN_NOT_RESOLVE=30009]="RC_DOMAIN_NOT_RESOLVE",a[a.RC_SOCKET_NOT_CREATED=30010]="RC_SOCKET_NOT_CREATED",a[a.RC_SOCKET_DISCONNECTED=30011]="RC_SOCKET_DISCONNECTED",a[a.RC_PING_SEND_FAIL=30012]="RC_PING_SEND_FAIL",a[a.RC_PONG_RECV_FAIL=30013]="RC_PONG_RECV_FAIL",a[a.RC_MSG_SEND_FAIL=30014]="RC_MSG_SEND_FAIL",a[a.RC_CONN_ACK_TIMEOUT=31e3]="RC_CONN_ACK_TIMEOUT",a[a.RC_CONN_PROTO_VERSION_ERROR=31001]="RC_CONN_PROTO_VERSION_ERROR",a[a.RC_CONN_ID_REJECT=31002]="RC_CONN_ID_REJECT",a[a.RC_CONN_SERVER_UNAVAILABLE=31003]="RC_CONN_SERVER_UNAVAILABLE",a[a.RC_CONN_USER_OR_PASSWD_ERROR=31004]="RC_CONN_USER_OR_PASSWD_ERROR",a[a.RC_CONN_NOT_AUTHRORIZED=31005]="RC_CONN_NOT_AUTHRORIZED",a[a.RC_CONN_REDIRECTED=31006]="RC_CONN_REDIRECTED",a[a.RC_CONN_PACKAGE_NAME_INVALID=31007]="RC_CONN_PACKAGE_NAME_INVALID",a[a.RC_CONN_APP_BLOCKED_OR_DELETED=31008]="RC_CONN_APP_BLOCKED_OR_DELETED",a[a.RC_CONN_USER_BLOCKED=31009]="RC_CONN_USER_BLOCKED",a[a.RC_DISCONN_KICK=31010]="RC_DISCONN_KICK",a[a.RC_DISCONN_EXCEPTION=31011]="RC_DISCONN_EXCEPTION",a[a.RC_QUERY_ACK_NO_DATA=32001]="RC_QUERY_ACK_NO_DATA",a[a.RC_MSG_DATA_INCOMPLETE=32002]="RC_MSG_DATA_INCOMPLETE",a[a.BIZ_ERROR_CLIENT_NOT_INIT=33001]="BIZ_ERROR_CLIENT_NOT_INIT",a[a.BIZ_ERROR_DATABASE_ERROR=33002]="BIZ_ERROR_DATABASE_ERROR",a[a.BIZ_ERROR_INVALID_PARAMETER=33003]="BIZ_ERROR_INVALID_PARAMETER",a[a.BIZ_ERROR_NO_CHANNEL=33004]="BIZ_ERROR_NO_CHANNEL",a[a.BIZ_ERROR_RECONNECT_SUCCESS=33005]="BIZ_ERROR_RECONNECT_SUCCESS",a[a.BIZ_ERROR_CONNECTING=33006]="BIZ_ERROR_CONNECTING",a[a.MSG_ROAMING_SERVICE_UNAVAILABLE=33007]="MSG_ROAMING_SERVICE_UNAVAILABLE",a[a.FORBIDDEN_IN_GROUP=22408]="FORBIDDEN_IN_GROUP",a[a.CONVER_REMOVE_ERROR=34001]="CONVER_REMOVE_ERROR",a[a.CONVER_GETLIST_ERROR=34002]="CONVER_GETLIST_ERROR",a[a.CONVER_SETOP_ERROR=34003]="CONVER_SETOP_ERROR",a[a.CONVER_TOTAL_UNREAD_ERROR=34004]="CONVER_TOTAL_UNREAD_ERROR",a[a.CONVER_TYPE_UNREAD_ERROR=34005]="CONVER_TYPE_UNREAD_ERROR",a[a.CONVER_ID_TYPE_UNREAD_ERROR=34006]="CONVER_ID_TYPE_UNREAD_ERROR",a[a.GROUP_SYNC_ERROR=35001]="GROUP_SYNC_ERROR",a[a.GROUP_MATCH_ERROR=35002]="GROUP_MATCH_ERROR",a[a.CHATROOM_ID_ISNULL=36001]="CHATROOM_ID_ISNULL",a[a.CHARTOOM_JOIN_ERROR=36002]="CHARTOOM_JOIN_ERROR",a[a.CHATROOM_HISMESSAGE_ERROR=36003]="CHATROOM_HISMESSAGE_ERROR",a[a.BLACK_ADD_ERROR=37001]="BLACK_ADD_ERROR",a[a.BLACK_GETSTATUS_ERROR=37002]="BLACK_GETSTATUS_ERROR",a[a.BLACK_REMOVE_ERROR=37003]="BLACK_REMOVE_ERROR",a[a.DRAF_GET_ERROR=38001]="DRAF_GET_ERROR",a[a.DRAF_SAVE_ERROR=38002]="DRAF_SAVE_ERROR",a[a.DRAF_REMOVE_ERROR=38003]="DRAF_REMOVE_ERROR",a[a.SUBSCRIBE_ERROR=39001]="SUBSCRIBE_ERROR",a[a.QNTKN_FILETYPE_ERROR=41001]="QNTKN_FILETYPE_ERROR",a[a.QNTKN_GET_ERROR=41002]="QNTKN_GET_ERROR",a[a.COOKIE_ENABLE=51001]="COOKIE_ENABLE"}(a.ErrorCode||(a.ErrorCode={}));a.ErrorCode;!function(a){a[a.IMAGE=1]="IMAGE",a[a.AUDIO=2]="AUDIO",a[a.VIDEO=3]="VIDEO",a[a.FILE=100]="FILE"}(a.MediaType||(a.MediaType={}));a.MediaType;!function(a){a[a.SEND=1]="SEND",a[a.RECEIVE=2]="RECEIVE"}(a.MessageDirection||(a.MessageDirection={}));a.MessageDirection;!function(a){a[a.IMAGE=1]="IMAGE",a[a.AUDIO=2]="AUDIO",a[a.VIDEO=3]="VIDEO"}(a.FileType||(a.FileType={}));a.FileType;!function(a){a[a.RC_REAL_TIME_LOCATION_NOT_INIT=-1]="RC_REAL_TIME_LOCATION_NOT_INIT",a[a.RC_REAL_TIME_LOCATION_SUCCESS=0]="RC_REAL_TIME_LOCATION_SUCCESS",a[a.RC_REAL_TIME_LOCATION_GPS_DISABLED=1]="RC_REAL_TIME_LOCATION_GPS_DISABLED",a[a.RC_REAL_TIME_LOCATION_CONVERSATION_NOT_SUPPORT=2]="RC_REAL_TIME_LOCATION_CONVERSATION_NOT_SUPPORT",a[a.RC_REAL_TIME_LOCATION_IS_ON_GOING=3]="RC_REAL_TIME_LOCATION_IS_ON_GOING",a[a.RC_REAL_TIME_LOCATION_EXCEED_MAX_PARTICIPANT=4]="RC_REAL_TIME_LOCATION_EXCEED_MAX_PARTICIPANT",a[a.RC_REAL_TIME_LOCATION_JOIN_FAILURE=5]="RC_REAL_TIME_LOCATION_JOIN_FAILURE",a[a.RC_REAL_TIME_LOCATION_START_FAILURE=6]="RC_REAL_TIME_LOCATION_START_FAILURE",a[a.RC_REAL_TIME_LOCATION_NETWORK_UNAVAILABLE=7]="RC_REAL_TIME_LOCATION_NETWORK_UNAVAILABLE"}(a.RealTimeLocationErrorCode||(a.RealTimeLocationErrorCode={}));a.RealTimeLocationErrorCode;!function(a){a[a.RC_REAL_TIME_LOCATION_STATUS_IDLE=0]="RC_REAL_TIME_LOCATION_STATUS_IDLE",a[a.RC_REAL_TIME_LOCATION_STATUS_INCOMING=1]="RC_REAL_TIME_LOCATION_STATUS_INCOMING",a[a.RC_REAL_TIME_LOCATION_STATUS_OUTGOING=2]="RC_REAL_TIME_LOCATION_STATUS_OUTGOING",a[a.RC_REAL_TIME_LOCATION_STATUS_CONNECTED=3]="RC_REAL_TIME_LOCATION_STATUS_CONNECTED"}(a.RealTimeLocationStatus||(a.RealTimeLocationStatus={}));a.RealTimeLocationStatus;!function(a){a[a.READ=1]="READ",a[a.LISTENED=2]="LISTENED",a[a.DOWNLOADED=4]="DOWNLOADED"}(a.ReceivedStatus||(a.ReceivedStatus={}));a.ReceivedStatus;!function(a){a[a.EXACT=0]="EXACT",a[a.FUZZY=1]="FUZZY"}(a.SearchType||(a.SearchType={}));a.SearchType;!function(a){a[a.SENDING=10]="SENDING",a[a.FAILED=20]="FAILED",a[a.SENT=30]="SENT",a[a.RECEIVED=40]="RECEIVED",a[a.READ=50]="READ",a[a.DESTROYED=60]="DESTROYED"}(a.SentStatus||(a.SentStatus={}));a.SentStatus;!function(a){a[a.ACCEPTED=0]="ACCEPTED",a[a.UNACCEPTABLE_PROTOCOL_VERSION=1]="UNACCEPTABLE_PROTOCOL_VERSION",a[a.IDENTIFIER_REJECTED=2]="IDENTIFIER_REJECTED",a[a.SERVER_UNAVAILABLE=3]="SERVER_UNAVAILABLE",a[a.TOKEN_INCORRECT=4]="TOKEN_INCORRECT",a[a.NOT_AUTHORIZED=5]="NOT_AUTHORIZED",a[a.REDIRECT=6]="REDIRECT",a[a.PACKAGE_ERROR=7]="PACKAGE_ERROR",a[a.APP_BLOCK_OR_DELETE=8]="APP_BLOCK_OR_DELETE",a[a.BLOCK=9]="BLOCK",a[a.TOKEN_EXPIRE=10]="TOKEN_EXPIRE",a[a.DEVICE_ERROR=11]="DEVICE_ERROR"}(a.ConnectionState||(a.ConnectionState={}));a.ConnectionState}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(){}return b.getInstance=function(){if(!b._instance)throw new Error("RongIMClient is not initialized. Call .init() method first.");return b._instance},b.init=function(c,d){b._instance||(b._instance=new b);var e=new a.FeaturePatcher;e.patchAll(),b._memoryStore={token:"",callback:null,hasModules:!0,global:window,lastReadTime:new a.LimitableMap,conversationList:[],appKey:c,publicServiceMap:new a.PublicServiceMap,listenerList:[],providerType:1,deltaTime:0,filterMessages:[],isSyncRemoteConverList:!1},b._cookieHelper=new a.CookieProvider,d&&"[object Object]"==Object.prototype.toString.call(d)?b._dataAccessProvider=d:b._dataAccessProvider=new a.ServerDataProvider,b.MessageParams={TextMessage:{objectName:"RC:TxtMsg",msgTag:new a.MessageTag(!0,!0)},ImageMessage:{objectName:"RC:ImgMsg",msgTag:new a.MessageTag(!0,!0)},DiscussionNotificationMessage:{objectName:"RC:DizNtf",msgTag:new a.MessageTag(!0,!0)},VoiceMessage:{objectName:"RC:VcMsg",msgTag:new a.MessageTag(!0,!0)},RichContentMessage:{objectName:"RC:ImgTextMsg",msgTag:new a.MessageTag(!0,!0)},HandshakeMessage:{objectName:"",msgTag:new a.MessageTag(!0,!0)},UnknownMessage:{objectName:"",msgTag:new a.MessageTag(!0,!0)},SuspendMessage:{objectName:"",msgTag:new a.MessageTag(!0,!0)},LocationMessage:{objectName:"RC:LBSMsg",msgTag:new a.MessageTag(!0,!0)},InformationNotificationMessage:{objectName:"RC:InfoNtf",msgTag:new a.MessageTag(!0,!0)},ContactNotificationMessage:{objectName:"RC:ContactNtf",msgTag:new a.MessageTag(!0,!0)},ProfileNotificationMessage:{objectName:"RC:ProfileNtf",msgTag:new a.MessageTag(!0,!0)},CommandNotificationMessage:{objectName:"RC:CmdNtf",msgTag:new a.MessageTag(!0,!0)},CommandMessage:{objectName:"RC:CmdMsg",msgTag:new a.MessageTag(!1,!1)}},b.MessageType={TextMessage:"TextMessage",ImageMessage:"ImageMessage",DiscussionNotificationMessage:"DiscussionNotificationMessage",VoiceMessage:"VoiceMessage",RichContentMessage:"RichContentMessage",HandshakeMessage:"HandshakeMessage",UnknownMessage:"UnknownMessage",SuspendMessage:"SuspendMessage",LocationMessage:"LocationMessage",InformationNotificationMessage:"InformationNotificationMessage",ContactNotificationMessage:"ContactNotificationMessage",ProfileNotificationMessage:"ProfileNotificationMessage",CommandNotificationMessage:"CommandNotificationMessage",CommandMessage:"CommandMessage"}},b.connect=function(c,d){if(a.CheckParam.getInstance().check(["string","object"],"connect",!0),b.bridge=a.Bridge.getInstance(),b._memoryStore.token=c,b._memoryStore.callback=d,!navigator.cookieEnabled)return void d.onError(a.ErrorCode.COOKIE_ENABLE);b.bridge.connect(b._memoryStore.appKey,c,{onSuccess:function(a){d.onSuccess(a)},onError:function(b){b!=a.ConnectionState.TOKEN_INCORRECT&&b?d.onError(b):d.onTokenIncorrect()}});for(var e=0,f=b._memoryStore.listenerList.length;f>e;e++)b.bridge.setListener(b._memoryStore.listenerList[e]);return b._memoryStore.listenerList.length=0,b._instance},b.reconnect=function(a){b.bridge.reconnect(a)},b.registerMessageType=function(c,d,e,f){if(!c)throw new Error("messageType can't be empty,postion -> registerMessageType");if(!d)throw new Error("objectName can't be empty,postion -> registerMessageType");if("[object Array]"==Object.prototype.toString.call(f)){var g=a.ModelUtil.modleCreate(f);b.RegisterMessage[c]=g}else{if("[object Function]"!=Object.prototype.toString.call(f)&&"[object Object]"!=Object.prototype.toString.call(f))throw new Error("The index of 3 parameter was wrong type  must be object or function or array-> registerMessageType");if(!f.encode)throw new Error("encode method has not realized or messageName is undefined-> registerMessageType");if(!f.decode)throw new Error("decode method has not realized -> registerMessageType")}b.RegisterMessage[c].messageName=c,b.MessageType[c]=c,b.MessageParams[c]={objectName:d,msgTag:e},registerMessageTypeMapping[d]=c},b.setConnectionStatusListener=function(a){b.bridge?b.bridge.setListener(a):b._memoryStore.listenerList.push(a)},b.setOnReceiveMessageListener=function(a){b.bridge?b.bridge.setListener(a):b._memoryStore.listenerList.push(a)},b.prototype.logout=function(){b.bridge.disconnect(),b.bridge=null},b.prototype.disconnect=function(){b.bridge.disconnect()},b.prototype.getCurrentConnectionStatus=function(){return a.Bridge._client.channel.connectionStatus},b.prototype.getConnectionChannel=function(){return a.Transportations._TransportType==a.Socket.XHR_POLLING?a.ConnectionChannel.XHR_POLLING:a.Transportations._TransportType==a.Socket.WEBSOCKET?a.ConnectionChannel.WEBSOCKET:void 0},b.prototype.getStorageProvider=function(){return 1==b._memoryStore.providerType?"ServerDataProvider":"OtherDataProvider"},b.prototype.setFilterMessages=function(a){"[object Array]"==Object.prototype.toString.call(a)&&(b._memoryStore.filterMessages=a)},b.prototype.getCurrentUserId=function(){return a.Bridge._client.userId},b.prototype.getDeltaTime=function(){return b._memoryStore.deltaTime},b.prototype.clearMessages=function(a,c,d){b._dataAccessProvider.clearMessages(a,c,d)},b.prototype.clearMessagesUnreadStatus=function(a,c,d){b._dataAccessProvider.updateMessages(a,c,"readStatus",null,d)},b.prototype.deleteMessages=function(a,c,d,e){b._dataAccessProvider.removeMessage(a,c,d,e)},b.prototype.sendLocalMessage=function(c,d){a.CheckParam.getInstance().check(["object","object"],"sendLocalMessage"),b._dataAccessProvider.updateMessage(c),this.sendMessage(c.conversationType,c.targetId,c.content,d)},b.prototype.sendMessage=function(c,d,e,f){if(a.CheckParam.getInstance().check(["number","string","object","object"],"sendMessage"),!a.Bridge._client.channel)return void f.onError(a.ErrorCode.RC_NET_UNAVAILABLE,null);if(!a.Bridge._client.channel.socket.socket.connected)throw f.onError(a.ErrorCode.TIMEOUT,null),new Error("connect is timeout! postion:sendMessage");b._dataAccessProvider.addMessage(c,d,e);var g=new Modules.UpStreamMessage;g.setSessionId(b.MessageParams[e.messageName].msgTag.getMessageTag()),g.setClassname(b.MessageParams[e.messageName].objectName),g.setContent(e.encode());var h=g.toArrayBuffer();"[object ArrayBuffer]"==Object.prototype.toString.call(h)&&(h=[].slice.call(new Int8Array(h)));var i=null,j=this,k=new a.Message;this.getConversation(c,d,{onSuccess:function(a){i=a}}),k.content=e,k.conversationType=c,k.senderUserId=a.Bridge._client.userId,k.objectName=b.MessageParams[e.messageName].objectName,k.targetId=d,k.sentTime=(new Date).getTime(),k.messageDirection=a.MessageDirection.SEND,k.sentStatus=a.SentStatus.SENT,k.messageType=e.messageName,i||(i=j.createConversation(c,d,"")),i.sentTime=(new Date).getTime(),i.sentStatus=a.SentStatus.SENDING,i.senderUserName="",i.senderUserId=a.Bridge._client.userId,i.notificationStatus=a.ConversationNotificationStatus.DO_NOT_DISTURB,i.latestMessage=k,i.unreadMessageCount=0,i.setTop(),b.bridge.pubMsg(c.valueOf(),h,d,{onSuccess:function(b){k.messageUId=b.messageUId,k.sentTime=b.timestamp,k.sentStatus=a.SentStatus.SENT,i.latestMessage=k,f.onSuccess(k)},onError:function(b){k.sentStatus=a.SentStatus.FAILED,i.latestMessage=k,f.onError(b,k)}},null)},b.prototype.sendStatusMessage=function(a,b,c){throw new Error("Not implemented yet")},b.prototype.sendTextMessage=function(b,c,d,e){var f=a.TextMessage.obtain(d);this.sendMessage(b,c,f,e)},b.prototype.insertMessage=function(a,c,d,e,f){b._dataAccessProvider.addMessage(a,c,e,f)},b.prototype.getHistoryMessages=function(c,d,e,f,g){if(a.CheckParam.getInstance().check(["number","string","number|null|global|object","number","object"],"getHistoryMessages"),f>20)throw new Error("HistroyMessage count must be less than or equal to 20!");if(c.valueOf()<0)throw new Error("ConversationType must be greater than -1");b._dataAccessProvider.getHistoryMessages(c,d,e,f,g)},b.prototype.getRemoteHistoryMessages=function(c,d,e,f,g){if(a.CheckParam.getInstance().check(["number","string","number|null|global|object","number","object"],"getRemoteHistoryMessages"),f>20)return void g.onError(a.ErrorCode.RC_CONN_PROTO_VERSION_ERROR);if(c.valueOf()<0)return void g.onError(a.ErrorCode.RC_CONN_PROTO_VERSION_ERROR);var h=new Modules.HistoryMessageInput;h.setTargetId(d),e?h.setDataTime(e):h.setDataTime(b._memoryStore.lastReadTime.get(c+d)),h.setSize(f),b.bridge.queryMsg(HistoryMsgType[c],a.MessageUtil.ArrayForm(h.toArrayBuffer()),d,{onSuccess:function(e){b._memoryStore.lastReadTime.set(c+d,a.MessageUtil.int64ToTimestamp(e.syncTime));for(var f=e.list.reverse(),h=0,i=f.length;i>h;h++)f[h]=a.MessageUtil.messageParser(f[h]);g.onSuccess(f,!!e.hasMsg)},onError:function(){g.onSuccess([],!1)}},"HistoryMessagesOuput")},b.prototype.hasRemoteUnreadMessages=function(c,d){var e=null;window.RCCallback=function(a){d.onSuccess(!!+a.status),e.parentNode.removeChild(e)},e=document.createElement("script"),e.src=a.MessageUtil.schemeArrs[b.schemeType][0]+"://api.cn.ronghub.com/message/exist.js?appKey="+encodeURIComponent(b._memoryStore.appKey)+"&token="+encodeURIComponent(c)+"&callBack=RCCallback&_="+Date.now(),document.body.appendChild(e),e.onerror=function(){d.onError(a.ErrorCode.UNKNOWN),e.parentNode.removeChild(e)}},b.prototype.getTotalUnreadCount=function(a){b._dataAccessProvider.getTotalUnreadCount(a)},b.prototype.getConversationUnreadCount=function(a,c){b._dataAccessProvider.getConversationUnreadCount(a,c)},b.prototype.getUnreadCount=function(a,c,d){b._dataAccessProvider.getUnreadCount(a,c,d)},b.prototype.clearUnreadCount=function(a,c,d){b._dataAccessProvider.clearUnreadCount(a,c,d)},b.prototype.setMessageExtra=function(a,c,d){b._dataAccessProvider.setMessageExtra(a,c,d)},b.prototype.setMessageReceivedStatus=function(a,c,d){b._dataAccessProvider.setMessageReceivedStatus(a,c,d)},b.prototype.setMessageSentStatus=function(a,c,d){b._dataAccessProvider.setMessageSentStatus(a,c,d)},b.prototype.clearTextMessageDraft=function(c,d){a.CheckParam.getInstance().check(["number","string","object"],"clearTextMessageDraft");var e="darf_"+c+"_"+d;return delete b._memoryStore[e],!0},b.prototype.getTextMessageDraft=function(c,d){if(a.CheckParam.getInstance().check(["number","string","object"],"getTextMessageDraft"),""==d||0>c)throw new Error("params error : "+a.ErrorCode.DRAF_GET_ERROR);var e="darf_"+c+"_"+d;return b._memoryStore[e]},b.prototype.saveTextMessageDraft=function(c,d,e){a.CheckParam.getInstance().check(["number","string","string","object"],"saveTextMessageDraft");var f="darf_"+c+"_"+d;return b._memoryStore[f]=e,!0},b.prototype.clearConversations=function(c){for(var d=[],e=1;e<arguments.length;e++)d[e-1]=arguments[e];0==d.length&&(d=[a.ConversationType.CHATROOM,a.ConversationType.CUSTOMER_SERVICE,a.ConversationType.DISCUSSION,a.ConversationType.GROUP,a.ConversationType.PRIVATE,a.ConversationType.SYSTEM,a.ConversationType.PUBLIC_SERVICE,a.ConversationType.APP_PUBLIC_SERVICE]),b._dataAccessProvider.clearConversations(d,c)},b.prototype.getConversation=function(c,d,e){a.CheckParam.getInstance().check(["number","string","object"],"getConversation");var f=b._dataAccessProvider.getConversation(c,d);e.onSuccess(f)},b.prototype.pottingConversation=function(c){var d=b._dataAccessProvider.getConversation(c.type,c.userId),e=this,f=!1;d?f=!0:d=new a.Conversation,d.conversationType=c.type,d.targetId=c.userId,d.latestMessage=a.MessageUtil.messageParser(c.msg),d.latestMessageId=d.latestMessage.messageId,d.objectName=d.latestMessage.objectName,d.receivedStatus=d.latestMessage.receivedStatus,d.receivedTime=d.latestMessage.receiveTime,d.sentStatus=d.latestMessage.sentStatus,d.sentTime=d.latestMessage.sentTime,f||(d.unreadMessageCount=0),d.conversationType==a.ConversationType.DISCUSSION&&e.getDiscussion(c.userId,{onSuccess:function(a){d.conversationTitle=a.name},onError:function(a){}}),b._dataAccessProvider.addConversation(d,{
onSuccess:function(a){}})},b.prototype.sortConversationList=function(a){for(var c=[],d=0,e=a.length;e>d;d++)if(a[d].isTop)c.push(a[d]),a.splice(d,1);else for(var f=0;e-d-1>f;f++)if(a[f].sentTime<a[f+1].sentTime){var g=a[f];a[f]=a[f+1],a[f+1]=g}b._memoryStore.conversationList=c.concat(a)},b.prototype.getConversationList=function(c,d){a.CheckParam.getInstance().check(["object","null|array|object|global"],"getConversationList");var e=this;b._dataAccessProvider.getConversationList({onSuccess:function(a){d?c.onSuccess(a):(e.sortConversationList(b._memoryStore.conversationList),c.onSuccess(b._memoryStore.conversationList))}},d)},b.prototype.getRemoteConversationList=function(c,d){a.CheckParam.getInstance().check(["object","null|array|object|global"],"getRemoteConversationList");var e=new Modules.RelationsInput,f=this;e.setType(1),b.bridge.queryMsg(26,a.MessageUtil.ArrayForm(e.toArrayBuffer()),a.Bridge._client.userId,{onSuccess:function(a){if(a.info)for(var e=0,g=a.info.length;g>e;e++)f.pottingConversation(a.info[e]);if(d){var h=[];Array.forEach(d,function(a){Array.forEach(b._memoryStore.conversationList,function(b){b.conversationType==a&&h.push(b)})}),c.onSuccess(h)}else c.onSuccess(b._memoryStore.conversationList)},onError:function(){c.onSuccess([])}},"RelationsOutput")},b.prototype.createConversation=function(c,d,e){a.CheckParam.getInstance().check(["number","string","string"],"createConversation");var f=new a.Conversation;return f.targetId=d,f.conversationType=c,f.conversationTitle=e,f.latestMessage={},f.unreadMessageCount=0,b._dataAccessProvider.addConversation(f,{onSuccess:function(a){}}),f},b.prototype.removeConversation=function(c,d,e){a.CheckParam.getInstance().check(["number","string","object"],"removeConversation");var f=new Modules.RelationsInput;f.setType(c),b.bridge.queryMsg(27,a.MessageUtil.ArrayForm(f.toArrayBuffer()),d,{onSuccess:function(){b._dataAccessProvider.removeConversation(c,d,{onSuccess:function(){e.onSuccess(!0)},onError:function(){e.onError(a.ErrorCode.CONVER_REMOVE_ERROR)}})},onError:function(){e.onError(a.ErrorCode.CONVER_REMOVE_ERROR)}})},b.prototype.setConversationToTop=function(c,d,e){a.CheckParam.getInstance().check(["number","string","object"],"setConversationToTop"),b._dataAccessProvider.setConversationToTop(c,d,e)},b.prototype.getConversationNotificationStatus=function(a,b,c){throw new Error("Not implemented yet")},b.prototype.setConversationNotificationStatus=function(a,b,c,d){throw new Error("Not implemented yet")},b.prototype.getNotificationQuietHours=function(a){throw new Error("Not implemented yet")},b.prototype.removeNotificationQuietHours=function(a){throw new Error("Not implemented yet")},b.prototype.setNotificationQuietHours=function(a,b,c){throw new Error("Not implemented yet")},b.prototype.addMemberToDiscussion=function(c,d,e){a.CheckParam.getInstance().check(["string","array","object"],"addMemberToDiscussion");var f=new Modules.ChannelInvitationInput;f.setUsers(d),b.bridge.queryMsg(0,a.MessageUtil.ArrayForm(f.toArrayBuffer()),c,{onSuccess:function(){e.onSuccess()},onError:function(){e.onError(a.ErrorCode.JOIN_IN_DISCUSSION)}})},b.prototype.createDiscussion=function(c,d,e){a.CheckParam.getInstance().check(["string","array","object"],"createDiscussion");var f=new Modules.CreateDiscussionInput,g=this;f.setName(c),b.bridge.queryMsg(1,a.MessageUtil.ArrayForm(f.toArrayBuffer()),a.Bridge._client.userId,{onSuccess:function(a){d.length>0&&g.addMemberToDiscussion(a,d,{onSuccess:function(){},onError:function(a){e.onError(a)}}),e.onSuccess(a)},onError:function(){e.onError(a.ErrorCode.CREATE_DISCUSSION)}},"CreateDiscussionOutput")},b.prototype.getDiscussion=function(c,d){a.CheckParam.getInstance().check(["string","object"],"getDiscussion");var e=new Modules.ChannelInfoInput;e.setNothing(1),b.bridge.queryMsg(4,a.MessageUtil.ArrayForm(e.toArrayBuffer()),c,d,"ChannelInfoOutput")},b.prototype.quitDiscussion=function(c,d){a.CheckParam.getInstance().check(["string","object"],"quitDiscussion");var e=new Modules.LeaveChannelInput;e.setNothing(1),b.bridge.queryMsg(7,a.MessageUtil.ArrayForm(e.toArrayBuffer()),c,d)},b.prototype.removeMemberFromDiscussion=function(c,d,e){a.CheckParam.getInstance().check(["string","string","object"],"removeMemberFromDiscussion");var f=new Modules.ChannelEvictionInput;f.setUser(d),b.bridge.queryMsg(9,a.MessageUtil.ArrayForm(f.toArrayBuffer()),c,e)},b.prototype.setDiscussionInviteStatus=function(c,d,e){a.CheckParam.getInstance().check(["string","number","object"],"setDiscussionInviteStatus");var f=new Modules.ModifyPermissionInput;f.setOpenStatus(d.valueOf()),b.bridge.queryMsg(11,a.MessageUtil.ArrayForm(f.toArrayBuffer()),c,{onSuccess:function(a){e.onSuccess()},onError:function(){e.onError(a.ErrorCode.INVITE_DICUSSION)}})},b.prototype.setDiscussionName=function(c,d,e){a.CheckParam.getInstance().check(["string","string","object"],"setDiscussionName");var f=new Modules.RenameChannelInput;f.setName(d),b.bridge.queryMsg(12,a.MessageUtil.ArrayForm(f.toArrayBuffer()),c,e)},b.prototype.joinGroup=function(c,d,e){a.CheckParam.getInstance().check(["string","string","object"],"joinGroup");var f=new Modules.GroupInfo;f.setId(c),f.setName(d);var g=new Modules.GroupInput;g.setGroupInfo([f]),b.bridge.queryMsg(6,a.MessageUtil.ArrayForm(g.toArrayBuffer()),c,e,"GroupOutput")},b.prototype.quitGroup=function(c,d){a.CheckParam.getInstance().check(["string","object"],"quitGroup");var e=new Modules.LeaveChannelInput;e.setNothing(1),b.bridge.queryMsg(8,a.MessageUtil.ArrayForm(e.toArrayBuffer()),c,d)},b.prototype.syncGroup=function(c,d){a.CheckParam.getInstance().check(["array","object"],"syncGroup");for(var e=0,f=[],g=[],h=c.length;h>e;e++)if(0===f.length||!(c[e].id in f)){f.push(c[e].id);var i=new Modules.GroupInfo;i.setId(c[e].id),i.setName(c[e].name),g.push(i)}var j=new Modules.GroupHashInput;j.setUserId(a.Bridge._client.userId),j.setGroupHashCode(md5(f.sort().join(""))),b.bridge.queryMsg(13,a.MessageUtil.ArrayForm(j.toArrayBuffer()),a.Bridge._client.userId,{onSuccess:function(c){if(1===c){var e=new Modules.GroupInput;e.setGroupInfo(g),b.bridge.queryMsg(20,a.MessageUtil.ArrayForm(e.toArrayBuffer()),a.Bridge._client.userId,{onSuccess:function(){d.onSuccess()},onError:function(){d.onError(a.ErrorCode.GROUP_MATCH_ERROR)}},"GroupOutput")}else d.onSuccess()},onError:function(){d.onError(a.ErrorCode.GROUP_SYNC_ERROR)}},"GroupHashOutput")},b.prototype.joinChatRoom=function(c,d,e){if(a.CheckParam.getInstance().check(["string","number","object"],"joinChatRoom"),""==c)return void e.onError(a.ErrorCode.CHATROOM_ID_ISNULL);a.Bridge._client.chatroomId=c;var f=new Modules.ChrmInput;f.setNothing(1),b.bridge.queryMsg(19,a.MessageUtil.ArrayForm(f.toArrayBuffer()),c,{onSuccess:function(){e.onSuccess();var f=new Modules.ChrmPullMsg;0==d&&(d=-1),f.setCount(d),f.setSyncTime(0),a.Bridge._client.queryMessage("chrmPull",a.MessageUtil.ArrayForm(f.toArrayBuffer()),c,1,{onSuccess:function(c){var d=a.MessageUtil.int64ToTimestamp(c.syncTime);b._cookieHelper.setItem(a.Bridge._client.userId+"CST",d);var e=c.list;if(b._memoryStore.filterMessages.length>0)for(var f=0,g=e.length;g>f;f++)for(var h=0,i=b._memoryStore.filterMessages.length;i>h;h++)b.MessageParams[b._memoryStore.filterMessages[h]].objectName!=e[f].classname&&a.Bridge._client.handler.onReceived(e[f]);else for(var f=0,j=e.length;j>f;f++)a.Bridge._client.handler.onReceived(e[f])},onError:function(b){e.onError(a.ErrorCode.CHATROOM_HISMESSAGE_ERROR)}},"DownStreamMessages")},onError:function(){e.onError(a.ErrorCode.CHARTOOM_JOIN_ERROR)}},"ChrmOutput")},b.prototype.quitChatRoom=function(c,d){a.CheckParam.getInstance().check(["string","object"],"quitChatRoom");var e=new Modules.ChrmInput;e.setNothing(1),b.bridge.queryMsg(17,a.MessageUtil.ArrayForm(e.toArrayBuffer()),c,d,"ChrmOutput")},b.prototype.getRemotePublicServiceList=function(c,d,e,f){var g=new Modules.PullMpInput;e?g.setTime(b._memoryStore.lastReadTime.get(d+a.Bridge._client.userId)):g.setTime(0),g.setMpid(""),b.bridge.queryMsg(28,a.MessageUtil.ArrayForm(g.toArrayBuffer()),a.Bridge._client.userId,{onSuccess:function(a){b._memoryStore.publicServiceMap.publicServiceList.length=0,b._memoryStore.publicServiceMap.publicServiceList=a},onError:function(){}},"PullMpOutput")},b.prototype.getPublicServiceList=function(c){a.CheckParam.getInstance().check(["object"],"getPublicServiceList"),c.onSuccess(b._memoryStore.publicServiceMap.publicServiceList)},b.prototype.getPublicServiceProfile=function(c,d,e){a.CheckParam.getInstance().check(["number","string","object"],"getPublicServiceProfile");var f=b._memoryStore.publicServiceMap.get(c,d);e.onSuccess(f)},b.prototype.pottingPublicSearchType=function(a,b){var c=0;return 0==a?(c|=3,c|=0==b?12:48):1==a?(c|=1,c|=0==b?8:32):(c|=2,c|=0==a?4:16),c},b.prototype.searchPublicService=function(c,d,e){a.CheckParam.getInstance().check(["number","string","object"],"searchPublicService");var f=new Modules.SearchMpInput;f.setType(this.pottingPublicSearchType(0,c)),f.setId(d),b.bridge.queryMsg(29,a.MessageUtil.ArrayForm(f.toArrayBuffer()),a.Bridge._client.userId,e,"SearchMpOutput")},b.prototype.searchPublicServiceByType=function(c,d,e,f){a.CheckParam.getInstance().check(["number","number","string","object"],"searchPublicServiceByType");var g=c==a.ConversationType.APP_PUBLIC_SERVICE?2:1,h=new Modules.SearchMpInput;h.setType(this.pottingPublicSearchType(g,d)),h.setId(e),b.bridge.queryMsg(29,a.MessageUtil.ArrayForm(h.toArrayBuffer()),a.Bridge._client.userId,f,"SearchMpOutput")},b.prototype.subscribePublicService=function(c,d,e){a.CheckParam.getInstance().check(["number","string","object"],"subscribePublicService");var f=new Modules.MPFollowInput,g=this,h=c==a.ConversationType.APP_PUBLIC_SERVICE?"mcFollow":"mpFollow";f.setId(d),b.bridge.queryMsg(h,a.MessageUtil.ArrayForm(f.toArrayBuffer()),a.Bridge._client.userId,{onSuccess:function(){g.getRemotePublicServiceList(null,null,null,{onSuccess:function(){},onError:function(){}}),e.onSuccess()},onError:function(){e.onError(a.ErrorCode.SUBSCRIBE_ERROR)}},"MPFollowOutput")},b.prototype.unsubscribePublicService=function(c,d,e){a.CheckParam.getInstance().check(["number","string","object"],"unsubscribePublicService");var f=new Modules.MPFollowInput,g=c==a.ConversationType.APP_PUBLIC_SERVICE?"mcUnFollow":"mpUnFollow";f.setId(d),b.bridge.queryMsg(g,a.MessageUtil.ArrayForm(f.toArrayBuffer()),a.Bridge._client.userId,{onSuccess:function(){b._memoryStore.publicServiceMap.remove(c,d),e.onSuccess()},onError:function(){e.onError(a.ErrorCode.SUBSCRIBE_ERROR)}},"MPFollowOutput")},b.prototype.addToBlacklist=function(c,d){a.CheckParam.getInstance().check(["string","object"],"addToBlacklist");var e=new Modules.Add2BlackListInput;e.setUserId(c),b.bridge.queryMsg(21,a.MessageUtil.ArrayForm(e.toArrayBuffer()),c,{onSuccess:function(){d.onSuccess()},onError:function(){d.onError(a.ErrorCode.BLACK_ADD_ERROR)}})},b.prototype.getBlacklist=function(c){a.CheckParam.getInstance().check(["object"],"getBlacklist");var d=new Modules.QueryBlackListInput;d.setNothing(1),b.bridge.queryMsg(23,a.MessageUtil.ArrayForm(d.toArrayBuffer()),a.Bridge._client.userId,c,"QueryBlackListOutput")},b.prototype.getBlacklistStatus=function(c,d){a.CheckParam.getInstance().check(["string","object"],"getBlacklistStatus");var e=new Modules.BlackListStatusInput;e.setUserId(c),b.bridge.queryMsg(24,a.MessageUtil.ArrayForm(e.toArrayBuffer()),c,{onSuccess:function(b){d.onSuccess(a.BlacklistStatus[b])},onError:function(){d.onError(a.ErrorCode.BLACK_GETSTATUS_ERROR)}})},b.prototype.removeFromBlacklist=function(c,d){a.CheckParam.getInstance().check(["string","object"],"removeFromBlacklist");var e=new Modules.RemoveFromBlackListInput;e.setUserId(c),b.bridge.queryMsg(22,a.MessageUtil.ArrayForm(e.toArrayBuffer()),c,{onSuccess:function(){d.onSuccess()},onError:function(){d.onError(a.ErrorCode.BLACK_REMOVE_ERROR)}})},b.prototype.getFileToken=function(c,d){if(a.CheckParam.getInstance().check(["number","object"],"getQnTkn"),!/(1|2|3)/.test(c.toString()))return void d.onError(a.ErrorCode.QNTKN_FILETYPE_ERROR);var e=new Modules.GetQNupTokenInput;e.setType(c),b.bridge.queryMsg(30,a.MessageUtil.ArrayForm(e.toArrayBuffer()),a.Bridge._client.userId,d,"GetQNupTokenOutput")},b.prototype.getFileUrl=function(c,d,e){if(a.CheckParam.getInstance().check(["number","string","object"],"getQnTkn"),!/(1|2|3)/.test(c.toString()))return void e.onError(a.ErrorCode.QNTKN_FILETYPE_ERROR);var f=new Modules.GetQNdownloadUrlInput;f.setType(c),f.setKey(d),b.bridge.queryMsg(31,a.MessageUtil.ArrayForm(f.toArrayBuffer()),a.Bridge._client.userId,e,"GetQNdownloadUrlOutput")},b.prototype.addRealTimeLocationListener=function(a,b,c){throw new Error("Not implemented yet")},b.prototype.getRealTimeLocation=function(a,b){throw new Error("Not implemented yet")},b.prototype.getRealTimeLocationCurrentState=function(a,b){throw new Error("Not implemented yet")},b.prototype.getRealTimeLocationParticipants=function(a,b){throw new Error("Not implemented yet")},b.prototype.joinRealTimeLocation=function(a,b){throw new Error("Not implemented yet")},b.prototype.quitRealTimeLocation=function(a,b){throw new Error("Not implemented yet")},b.prototype.startRealTimeLocation=function(a,b){throw new Error("Not implemented yet")},b.prototype.updateRealTimeLocationStatus=function(a,b,c,d){throw new Error("Not implemented yet")},b.schemeType=a.ConnectionChannel.HTTP,b.RegisterMessage={},b._memoryStore={},b.isNotPullMsg=!1,b}();a.RongIMClient=b,"function"==typeof require&&"object"==typeof module&&module&&module.id&&"object"==typeof exports&&exports?module.exports=a:"function"==typeof define&&define.amd?define("RongIMLib",["md5","http://cdn.ronghub.com/Long.js","http://cdn.ronghub.com/byteBuffer.js","http://cdn.ronghub.com/protobuf-min-2.7.js"],function(){return a}):window.RongIMClient=b}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){!function(a){a[a.AT_MOST_ONCE=0]="AT_MOST_ONCE",a[a.AT_LEAST_ONCE=1]="AT_LEAST_ONCE",a[a.EXACTLY_ONCE=2]="EXACTLY_ONCE",a[a.DEFAULT=3]="DEFAULT"}(a.Qos||(a.Qos={}));var b=a.Qos;!function(a){a[a.CONNECT=1]="CONNECT",a[a.CONNACK=2]="CONNACK",a[a.PUBLISH=3]="PUBLISH",a[a.PUBACK=4]="PUBACK",a[a.QUERY=5]="QUERY",a[a.QUERYACK=6]="QUERYACK",a[a.QUERYCON=7]="QUERYCON",a[a.SUBSCRIBE=8]="SUBSCRIBE",a[a.SUBACK=9]="SUBACK",a[a.UNSUBSCRIBE=10]="UNSUBSCRIBE",a[a.UNSUBACK=11]="UNSUBACK",a[a.PINGREQ=12]="PINGREQ",a[a.PINGRESP=13]="PINGRESP",a[a.DISCONNECT=14]="DISCONNECT"}(a.Type||(a.Type={}));var c=(a.Type,["invtDiz","crDiz","qnUrl","userInf","dizInf","userInf","joinGrp","quitDiz","exitGrp","evctDiz",["","ppMsgP","pdMsgP","pgMsgP","chatMsg","pcMsgP","","pmcMsgN","pmpMsgN"],"pdOpen","rename","uGcmpr","qnTkn","destroyChrm","createChrm","exitChrm","queryChrm","joinChrm","pGrps","addBlack","rmBlack","getBlack","blackStat","addRelation","qryRelation","delRelation","pullMp","schMp","qnTkn","qnUrl"]),d=function(){function b(c,d,f){if(this.connectionStatus=-1,this.url=c.host+"/websocket?appId="+f.appId+"&token="+encodeURIComponent(f.token)+"&sdkVer="+f.sdkVer+"&apiVer="+f.apiVer,this.self=f,this.socket=e.getInstance().createServer(),this.socket.connect(this.url,d),!("object"==typeof b._ConnectionStatusListener&&"onChanged"in b._ConnectionStatusListener))throw new Error("setConnectStatusListener:Parameter format is incorrect");var g=this;g.socket.on("StatusChanged",function(c){return c===a.ConnectionStatus.DISCONNECTED?(b._ConnectionStatusListener.onChanged(a.ConnectionStatus.DISCONNECTED),void f.clearHeartbeat()):(g.connectionStatus=c,void b._ConnectionStatusListener.onChanged(c))}),this.socket.on("message",f.handler.handleMessage),this.socket.on("disconnect",function(a){f.channel.socket.fire("StatusChanged",a?a:2)})}return b.prototype.writeAndFlush=function(a){this.socket.send(a)},b.prototype.reconnect=function(b){a.MessageIdHandler.clearMessageId(),this.socket=this.socket.reconnect(),b&&(this.self.reconnectObj=b)},b.prototype.disconnect=function(a){this.socket.disconnect(a)},b}();a.Channel=d;var e=function(){function b(){this.socket=null,this._events={}}return b.getInstance=function(){return new b},b.prototype.connect=function(a,b){return this.socket&&(a&&this.on("connect",b||new Function),a&&(this.currentURL=a),this.socket.createTransport(a)),this},b.prototype.createServer=function(){var a=this.getTransport(this.checkTransport());if(null===a)throw new Error("the channel was not supported");return a},b.prototype.getTransport=function(c){return c==b.XHR_POLLING?this.socket=new a.PollingTransportation(this):c==b.WEBSOCKET&&(this.socket=new a.SocketTransportation(this)),this},b.prototype.send=function(a){this.socket&&(this.checkTransport()==b.WEBSOCKET?this.socket.send(a):this.socket.send(this._encode(a)))},b.prototype.onMessage=function(a){this.fire("message",a)},b.prototype.disconnect=function(a){return this.socket.disconnect(),this.fire("disconnect",a),this},b.prototype.reconnect=function(){if(this.currentURL)return this.connect(this.currentURL,null);throw new Error("reconnect:no have URL")},b.prototype.checkTransport=function(){return a.RongIMClient._memoryStore.global.WEB_XHR_POLLING&&(a.Transportations._TransportType=b.XHR_POLLING),a.Transportations._TransportType},b.prototype.fire=function(a,b){if(a in this._events)for(var c=0,d=this._events[a].length;d>c;c++)this._events[a][c](b);return this},b.prototype.on=function(b,c){return"function"==typeof c&&b?(b in this._events?-1==a.MessageUtil.indexOf(this._events,c)&&this._events[b].push(c):this._events[b]=[c],this):this},b.prototype.removeEvent=function(a,b){if(a in this._events)for(var c=0,d=this._events[a].length;d>c;c++)this._events[a][c]==b&&this._events[a].splice(c,1);return this},b.prototype._encode=function(b){var c="?messageid="+b.getMessageId()+"&header="+b.getHeaderFlag()+"&sessionid="+a.RongIMClient._cookieHelper.getItem(a.Navigation.Endpoint.userId+"sId");return/(PubAckMessage|QueryConMessage)/.test(b._name)||(c+="&topic="+b.getTopic()+"&targetid="+(b.getTargetId()||"")),{url:c,data:"getData"in b?b.getData():""}},b.XHR_POLLING="xhr-polling",b.WEBSOCKET="websocket",b}();a.Socket=e;var f=function(){function c(a,b){this.timeoutMillis=1e5,this.timeout_=0,this.sdkVer="2.0.6",this.apiVer=Math.floor(1e6*Math.random()),this.channel=null,this.handler=null,this.userId="",this.reconnectObj={},this.heartbeat=0,this.chatroomId="",this.SyncTimeQueue=[],this.token=a,this.appId=b,this.SyncTimeQueue.state="complete"}return c.prototype.resumeTimer=function(){this.timeout_||(this.timeout_=setTimeout(function(){if(this.timeout_){try{this.channel.disconnect()}catch(a){throw new Error(a)}clearTimeout(this.timeout_),this.timeout_=0,this.channel.reconnect(),this.channel.socket.fire("StatusChanged",5)}},this.timeoutMillis))},c.prototype.pauseTimer=function(){this.timeout_&&(clearTimeout(this.timeout_),this.timeout_=0)},c.prototype.connect=function(b){if(a.Navigation.Endpoint.host){if(a.Transportations._TransportType==e.WEBSOCKET&&!window.WebSocket)return void b.onError(a.ConnectionState.UNACCEPTABLE_PROTOCOL_VERSION);this.handler=new h(this),this.handler.setConnectCallback(b);var c=this;this.channel=new d(a.Navigation.Endpoint,function(){a.Transportations._TransportType==e.WEBSOCKET&&c.keepLive()},this),this.channel.socket.fire("StatusChanged",1)}else b.onError(a.ConnectionState.NOT_AUTHORIZED)},c.prototype.keepLive=function(){this.heartbeat>0&&clearInterval(this.heartbeat);var b=this;this.heartbeat=setInterval(function(){b.resumeTimer(),b.channel.writeAndFlush(new a.PingReqMessage)},18e4)},c.prototype.clearHeartbeat=function(){clearInterval(this.heartbeat),this.heartbeat=0,this.pauseTimer()},c.prototype.publishMessage=function(c,d,e,f,g){var h=a.MessageIdHandler.messageIdPlus(this.channel.reconnect);if(h){var i=new a.PublishMessage(c,d,e);i.setMessageId(h),f?(i.setQos(b.AT_LEAST_ONCE),this.handler.putCallback(new a.PublishCallback(f.onSuccess,f.onError),i.getMessageId(),g)):i.setQos(b.AT_MOST_ONCE),this.channel.writeAndFlush(i)}},c.prototype.queryMessage=function(b,d,e,f,g,h){if("userInf"==b&&c.userInfoMapping[e])return void g.onSuccess(c.userInfoMapping[e]);var i=a.MessageIdHandler.messageIdPlus(this.channel.reconnect);if(i){var j=new a.QueryMessage(b,d,e);j.setMessageId(i),j.setQos(f),this.handler.putCallback(new a.QueryCallback(g.onSuccess,g.onError),j.getMessageId(),h),this.channel.writeAndFlush(j)}},c.prototype.invoke=function(c){var d,e,f,h,i=this,j=this.SyncTimeQueue.shift();if(void 0!=j){if(!window.Modules)for(var k=(new Date).getTime()+200,l=(new Date).getTime();k>l;)l=(new Date).getTime();if(this.SyncTimeQueue.state="pending",2!=j.type)d=a.RongIMClient._cookieHelper.getItem(this.userId)||"0",e=new Modules.SyncRequestMsg,e.setIspolling(!1),f="pullMsg",h=this.userId;else{if(d=a.RongIMClient._cookieHelper.getItem(this.userId+"CST")||"0",e=new Modules.ChrmPullMsg,e.setCount(0),f="chrmPull",""===this.chatroomId)throw new Error("syncTime:Received messages of chatroom but was not init");h=this.chatroomId}if(j.pulltime<=d)return this.SyncTimeQueue.state="complete",void this.invoke();c&&e.setIsPullSend(!0),e.setSyncTime(d),this.queryMessage(f,a.MessageUtil.ArrayForm(e.toArrayBuffer()),h,b.AT_LEAST_ONCE,{onSuccess:function(b){i.SyncTimeQueue.state="complete",i.invoke();var c=a.MessageUtil.int64ToTimestamp(b.syncTime),d=i.userId;"chrmPull"==f&&(d+="CST"),a.RongIMClient._memoryStore.isSyncRemoteConverList=!0,a.RongIMClient._cookieHelper.setItem(d,c);for(var e=b.list,h=0;h<e.length;h++)g._client.handler.onReceived(e[h])},onError:function(){i.SyncTimeQueue.state="complete",i.invoke()}},"DownStreamMessages")}},c.prototype.syncTime=function(a,b){this.SyncTimeQueue.push({type:a,pulltime:b}),1==this.SyncTimeQueue.length&&"complete"==this.SyncTimeQueue.state&&this.invoke(!a)},c.prototype.__init=function(b){this.channel=new d(a.Navigation.Endpoint,b,this)},c.userInfoMapping={},c}();a.Client=f;var g=function(){function e(){}return e.getInstance=function(){return new e},e.prototype.connect=function(b,c,d){return window.Modules?(e._client=(new a.Navigation).connect(b,c,d),e._client):void(a.RongIMClient._memoryStore.hasModules=!1)},e.prototype.setListener=function(a){"object"==typeof a&&("function"==typeof a.onChanged?d._ConnectionStatusListener=a:"function"==typeof a.onReceived&&(d._ReceiveMessageListener=a))},e.prototype.reconnect=function(a){e._client.channel.reconnect(a)},e.prototype.disconnect=function(){e._client.clearHeartbeat(),e._client.channel.disconnect(2)},e.prototype.queryMsg=function(a,d,f,g,h){"string"!=typeof a&&(a=c[a]),e._client.queryMessage(a,d,f,b.AT_MOST_ONCE,g,h)},e.prototype.pubMsg=function(a,b,d,f,g){e._client.publishMessage(c[10][a],b,d,f,g)},e}();a.Bridge=g;var h=function(){function b(a){if(this.map={},this.connectCallback=null,!d._ReceiveMessageListener)throw new Error("please set onReceiveMessageListener");this._onReceived=d._ReceiveMessageListener.onReceived,this._client=a}return b.prototype.putCallback=function(a,b,c){var d={Callback:a,Message:c};d.Callback.resumeTimer(),this.map[b]=d},b.prototype.setConnectCallback=function(b){b&&(this.connectCallback=new a.ConnectAck(b.onSuccess,b.onError,this._client),this.connectCallback.resumeTimer())},b.prototype.onReceived=function(b){var c,d,e;if("PublishMessage"!=b._name)c=b,a.RongIMClient._cookieHelper.setItem(this._client.userId,a.MessageUtil.int64ToTimestamp(c.dataTime));else{if("s_ntf"==b.getTopic())return c=Modules.NotifyMsg.decode(b.getData()),void this._client.syncTime(c.type,a.MessageUtil.int64ToTimestamp(c.time));if("s_msg"==b.getTopic())c=Modules.DownStreamMessage.decode(b.getData()),a.RongIMClient._cookieHelper.setItem(this._client.userId,a.MessageUtil.int64ToTimestamp(c.dataTime));else{if(g._client.sdkVer&&"1.0.0"==g._client.sdkVer)return;c=Modules.UpStreamMessage.decode(b.getData());var f=b.getTopic(),h=f.substr(0,2);c.groupId=b.getTargetId(),"pp"==h?c.type=1:"pd"==h?c.type=2:"pg"==h?c.type=3:"chat"==h&&(c.type=4),c.fromUserId=this._client.userId,c.dataTime=Date.parse((new Date).toString())}if(!c)return}if(d=a.MessageUtil.messageParser(c,this._onReceived),null!==d){if(e=a.RongIMClient._dataAccessProvider.getConversation(d.conversationType,d.targetId),e||(e=a.RongIMClient.getInstance().createConversation(d.conversationType,d.targetId,"")),0!=e.conversationType&&(e.unreadMessageCount=e.unreadMessageCount+1,a.MessageUtil.supportLargeStorage())){var i=a.LocalStorageProvider.getInstance().getItem("cu"+g._client.userId+e.conversationType+e.targetId);a.LocalStorageProvider.getInstance().setItem("cu"+g._client.userId+e.conversationType+d.targetId,Number(i)+1)}e.receivedTime=(new Date).getTime(),e.receivedStatus=a.ReceivedStatus.READ,e.senderUserId=d.sendUserId,e.notificationStatus=a.ConversationNotificationStatus.DO_NOT_DISTURB,e.latestMessageId=d.messageId,e.latestMessage=d,e.setTop(),this._onReceived(d)}},b.prototype.handleMessage=function(b){if(b)switch(b._name){case"ConnAckMessage":g._client.handler.connectCallback.process(b.getStatus(),b.getUserId(),b.getTimestamp());break;case"PublishMessage":0!=b.getQos()&&g._client.channel.writeAndFlush(new a.PubAckMessage(b.getMessageId())),g._client.handler.onReceived(b);break;case"QueryAckMessage":0!=b.getQos()&&g._client.channel.writeAndFlush(new a.QueryConMessage(b.getMessageId()));var c=g._client.handler.map[b.getMessageId()];c&&(c.Callback.process(b.getStatus(),b.getData(),b.getDate(),c.Message),delete g._client.handler.map[b.getMessageId()]);break;case"PubAckMessage":var d=g._client.handler.map[b.getMessageId()];d&&(d.Callback.process(b.getStatus()||0,b.getMessageUId(),b.getTimestamp(),d.Message),delete g._client.handler.map[b.getMessageId()]);break;case"PingRespMessage":g._client.pauseTimer();break;case"DisconnectMessage":g._client.channel.disconnect(b.getStatus())}},b}();a.MessageHandler=h}(RongIMLib||(RongIMLib={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},RongIMLib;!function(a){var b=function(){function b(a){this.timeout=null,this.onError=null,a&&"number"==typeof a?this.timeoutMillis=a:(this.timeoutMillis=6e3,this.onError=a)}return b.prototype.resumeTimer=function(){var a=this;this.timeoutMillis>0&&!this.timeout&&(this.timeout=setTimeout(function(){a.readTimeOut(!0)},this.timeoutMillis))},b.prototype.pauseTimer=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},b.prototype.readTimeOut=function(b){b&&this.onError?this.onError(a.ErrorCode.TIMEOUT):this.pauseTimer()},b}();a.MessageCallback=b;var c=function(){function b(){this.publicServiceList=[]}return b.getInstance=function(){return new b},b.prototype.pottingProfile=function(b){var c;this.profile=new a.PublicServiceProfile,c=JSON.parse(b.extra),this.profile.isGlobal=c.isGlobal,this.profile.introduction=c.introduction,this.profile.menu=c.menu,this.profile.hasFollowed=c.follow,this.profile.publicServiceId=b.mpid,this.profile.name=b.name,this.profile.portraitUri=b.portraitUrl,this.profile.conversationType="mc"==b.type?a.ConversationType.APP_PUBLIC_SERVICE:a.ConversationType.PUBLIC_SERVICE,this.publicServiceList.push(this.profile)},b.prototype.mapping=function(b,c){switch(c){case"GetUserInfoOutput":var d=new a.UserInfo(b.userId,b.userName,b.userPortrait);return d;case"GetQNupTokenOutput":return{deadline:a.MessageUtil.int64ToTimestamp(b.deadline),token:b.token};case"GetQNdownloadUrlOutput":return{downloadUrl:b.downloadUrl};case"CreateDiscussionOutput":return b.id;case"ChannelInfoOutput":var e=new a.Discussion;return e.creatorId=b.adminUserId,e.id=b.channelId,e.memberIdList=b.firstTenUserIds,e.name=b.channelName,e.isOpen=b.openStatus,e;case"GroupHashOutput":return b.result;case"QueryBlackListOutput":return b.userIds;case"SearchMpOutput":case"PullMpOutput":if(b.info){var f=this;Array.forEach(b.info,function(a){setTimeout(f.pottingProfile(a),100)})}return this.publicServiceList;default:return b}},b}();a.CallbackMapping=c;var d=function(a){function c(b,c){a.call(this,c),this._cb=b,this._timeout=c}return __extends(c,a),c.prototype.process=function(a,b,c,d){this.readTimeOut(),0==a?(d&&(d.setSentStatus=a),this._cb({messageUId:b,timestamp:c})):this._timeout(a)},c.prototype.readTimeOut=function(a){b.prototype.readTimeOut.call(this,a)},c}(b);a.PublishCallback=d;var e=function(d){function e(a,b){d.call(this,b),this._cb=a,this._timeout=b}return __extends(e,d),e.prototype.process=function(b,d,e,f){if(this.readTimeOut(),f&&d&&0==b){try{d=c.getInstance().mapping(Modules[f].decode(d),f)}catch(g){return void this._timeout(a.ErrorCode.UNKNOWN)}"GetUserInfoOutput"==f&&(a.Client.userInfoMapping[d.userId]=d),this._cb(d)}else b>0?this._timeout(b):this._cb(b)},e.prototype.readTimeOut=function(a){b.prototype.readTimeOut.call(this,a)},e}(b);a.QueryCallback=e;var f=function(c){function d(a,b,d){c.call(this,b),this._client=d,this._cb=a,this._timeout=b}return __extends(d,c),d.prototype.process=function(b,c,d){if(this.readTimeOut(),0==b){var e=a.RongIMClient._cookieHelper.getItem(a.RongIMClient._cookieHelper.getItemKey("navi")),f=a.RongIMClient._cookieHelper.getItemKey("navi"),g=decodeURIComponent(e).split(",");if(g[1]||(e=encodeURIComponent(e)+c,a.RongIMClient._cookieHelper.setItem(f,e)),this._client.userId=c,a.RongIMClient.isNotPullMsg||this._client.syncTime(),this._client.reconnectObj.onSuccess)this._client.reconnectObj.onSuccess(c),delete this._client.reconnectObj.onSuccess;else{var h=this;setTimeout(function(){h._cb(c)},500)}a.Bridge._client.channel.socket.fire("StatusChanged",0),a.RongIMClient._memoryStore.deltaTime=(new Date).getTime()-d}else if(6==b){var i={};(new a.Navigation).getServerEndpoint(this._client.token,this._client.appId,function(){this._client.clearHeartbeat(),new a.Client(this._client.token,this._client.appId).__init.call(i,function(){"websocket"==a.Transportations._TransportType&&this._client.keepLive()}),this._client.channel.socket.fire("StatusChanged",2)},this._timeout,!1)}else this._client.reconnectObj.onError?(this._client.reconnectObj.onError(b),delete this._client.reconnectObj.onError):this._timeout(b)},d.prototype.readTimeOut=function(a){b.prototype.readTimeOut.call(this,a)},d}(b);a.ConnectAck=f}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(){window.getServerEndpoint=function(c){a.RongIMClient._cookieHelper._host=b.Endpoint.host=c.server;var d=a.RongIMClient._cookieHelper.getItemKey("navi");null!==d&&a.RongIMClient._cookieHelper.removeItem(d),a.RongIMClient._cookieHelper.setItem("navi"+md5(a.Bridge._client.token).slice(8,16),c.server+","+(c.userId||""))}}return b.prototype.connect=function(b,c,d){var e=a.RongIMClient._cookieHelper.getItem("appId");e&&e!=b&&(a.RongIMClient._cookieHelper.clearItem(),a.RongIMClient._cookieHelper.setItem("appId",b)),e||a.RongIMClient._cookieHelper.setItem("appId",b);var f=new a.Client(c,b);return this.getServerEndpoint(c,b,function(){f.connect(d)},d.onError,!0),f},b.prototype.getServerEndpoint=function(c,d,e,f,g){if(g){var h=md5(c).slice(8,16),i=a.RongIMClient._cookieHelper.getItem(a.RongIMClient._cookieHelper.getItemKey("navi")),j=a.RongIMClient._cookieHelper.getItem("navi"+h);if(i==j&&null!==j&&a.RongIMClient._cookieHelper.getItem("rongSDK")==a.Transportations._TransportType){var k=decodeURIComponent(i).split(",");return void setTimeout(function(){a.RongIMClient._cookieHelper._host=b.Endpoint.host=k[0],b.Endpoint.userId=k[1],e()},500)}}var l={"navUrl-Debug":a.MessageUtil.schemeArrs[a.RongIMClient.schemeType][0]+"://119.254.111.49:9100/","navUrl-Release":a.MessageUtil.schemeArrs[a.RongIMClient.schemeType][0]+"://nav.cn.ronghub.com/"},m=document.createElement("script");m.src=l["navUrl-Release"]+(a.RongIMClient._memoryStore.global.WEB_XHR_POLLING?"cometnavi.js":"navi.js")+"?appId="+d+"&token="+encodeURIComponent(c)+"&callBack=getServerEndpoint&t="+(new Date).getTime(),document.body.appendChild(m),m.onerror=function(){f(a.ConnectionState.TOKEN_INCORRECT)},"onload"in m?m.onload=e:m.onreadystatechange=function(){"loaded"==m.readyState&&e()}},b.Endpoint=new Object,b}();a.Navigation=b}(RongIMLib||(RongIMLib={}));
var RongIMLib;!function(a){var b=function(){function b(b){this._name="BaseMessage",this.lengthSize=0,b instanceof a.Header?this._header=b:this._header=new a.Header(b,!1,a.Qos.AT_MOST_ONCE,!1)}return b.prototype.read=function(a,b){this.readMessage(a,b)},b.prototype.write=function(b){var c=new a.BinaryHelper,d=c.convertStream(b);return this._headerCode=this.getHeaderFlag(),d.write(this._headerCode),this.writeMessage(d),d},b.prototype.getHeaderFlag=function(){return this._header.encode()},b.prototype.getLengthSize=function(){return this.lengthSize},b.prototype.toBytes=function(){return this.write([]).getBytesArray()},b.prototype.isRetained=function(){return this._header.retain},b.prototype.setRetained=function(a){this._header.retain=a},b.prototype.setQos=function(b){this._header.qos="[object Object]"==Object.prototype.toString.call(b)?b:a.Qos[b]},b.prototype.setDup=function(a){this._header.dup=a},b.prototype.isDup=function(){return this._header.dup},b.prototype.getType=function(){return this._header.type},b.prototype.getQos=function(){return this._header.qos},b.prototype.messageLength=function(){return 0},b.prototype.writeMessage=function(a){},b.prototype.readMessage=function(a,b){},b.prototype.init=function(a){var b,c,d=this;for(c in a)a.hasOwnProperty(c)&&(b=c.replace(/^\w/,function(a){var b=a.charCodeAt(0);return"set"+(b>=97?String.fromCharCode(-33&b):a)}),b in d&&("status"==c?d[b](disconnectStatus[a[c]]?disconnectStatus[a[c]]:a[c]):d[b](a[c])))},b}();a.BaseMessage=b;var c=function(b){function c(c){switch(b.call(this,0==arguments.length||3==arguments.length?a.Type.CONNECT:arguments[0]),this._name="ConnectMessage",this.CONNECT_HEADER_SIZE=12,this.protocolId="RCloud",this.binaryHelper=new a.BinaryHelper,this.protocolVersion=3,arguments.length){case 0:case 1:case 3:if(!arguments[0]||arguments[0].length>64)throw new Error("ConnectMessage:Client Id cannot be null and must be at most 64 characters long: "+arguments[0]);this.clientId=arguments[0],this.cleanSession=arguments[1],this.keepAlive=arguments[2]}}return __extends(c,b),c.prototype.messageLength=function(){var a=this.binaryHelper.toMQttString(this.clientId).length;return a+=this.binaryHelper.toMQttString(this.willTopic).length,a+=this.binaryHelper.toMQttString(this.will).length,a+=this.binaryHelper.toMQttString(this.appId).length,a+=this.binaryHelper.toMQttString(this.token).length,a+this.CONNECT_HEADER_SIZE},c.prototype.readMessage=function(a){this.protocolId=a.readUTF(),this.protocolVersion=a.readByte();var b=a.readByte();if(this.hasAppId=(128&b)>0,this.hasToken=(64&b)>0,this.retainWill=(32&b)>0,this.willQos=b>>3&3,this.hasWill=(4&b)>0,this.cleanSession=(32&b)>0,this.keepAlive=256*a.read()+a.read(),this.clientId=a.readUTF(),this.hasWill&&(this.willTopic=a.readUTF(),this.will=a.readUTF()),this.hasAppId)try{this.appId=a.readUTF()}catch(c){throw new Error(c)}if(this.hasToken)try{this.token=a.readUTF()}catch(c){throw new Error(c)}return a},c.prototype.writeMessage=function(a){var b=this.binaryHelper.convertStream(a);b.writeUTF(this.protocolId),b.write(this.protocolVersion);var c=this.cleanSession?2:0;return c|=this.hasWill?4:0,c|=this.willQos?this.willQos>>3:0,c|=this.retainWill?32:0,c|=this.hasToken?64:0,c|=this.hasAppId?128:0,b.write(c),b.writeChar(this.keepAlive),b.writeUTF(this.clientId),this.hasWill&&(b.writeUTF(this.willTopic),b.writeUTF(this.will)),this.hasAppId&&b.writeUTF(this.appId),this.hasToken&&b.writeUTF(this.token),b},c}(b);a.ConnectMessage=c;var d=function(b){function c(c){b.call(this,0==arguments.length?a.Type.CONNACK:1==arguments.length?arguments[0]instanceof a.Header?arguments[0]:a.Type.CONNACK:null),this._name="ConnAckMessage",this.MESSAGE_LENGTH=2,this.binaryHelper=new a.BinaryHelper;var d=this;switch(arguments.length){case 0:case 1:if(!(arguments[0]instanceof a.Header)&&arguments[0]in a.ConnectionState){if(null==arguments[0])throw new Error("ConnAckMessage:The status of ConnAskMessage can't be null");d.setStatus(arguments[0])}}}return __extends(c,b),c.prototype.messageLength=function(){var a=this.MESSAGE_LENGTH;return this.userId&&(a+=this.binaryHelper.toMQttString(this.userId).length),a},c.prototype.readMessage=function(a,b){a.read();var c=+a.read();if(!(c>=0&&9>=c))throw new Error("Unsupported CONNACK code:"+c);if(this.setStatus(c),b>this.MESSAGE_LENGTH){this.setUserId(a.readUTF());var d=(a.readUTF(),a.readLong());this.setTimestamp(d)}},c.prototype.writeMessage=function(a){var b=this.binaryHelper.convertStream(a);switch(b.write(128),+status){case 0:case 1:case 2:case 5:case 6:b.write(+status);break;case 3:case 4:b.write(3);break;default:throw new Error("Unsupported CONNACK code:"+status)}return this.userId&&b.writeUTF(this.userId),b},c.prototype.setStatus=function(a){this.status=a},c.prototype.setUserId=function(a){this.userId=a},c.prototype.getStatus=function(){return this.status},c.prototype.getUserId=function(){return this.userId},c.prototype.setTimestamp=function(a){this.timestrap=a},c.prototype.getTimestamp=function(){return this.timestrap},c}(b);a.ConnAckMessage=d;var e=function(b){function c(c){b.call(this,c instanceof a.Header?c:a.Type.DISCONNECT),this._name="DisconnectMessage",this.MESSAGE_LENGTH=2,this.binaryHelper=new a.BinaryHelper,c instanceof a.Header||c in a.ConnectionStatus&&(this.status=c)}return __extends(c,b),c.prototype.messageLength=function(){return this.MESSAGE_LENGTH},c.prototype.readMessage=function(a){a.read();var b=+a.read();if(!(b>=0&&5>=b))throw new Error("Unsupported CONNACK code:"+b);this.setStatus(disconnectStatus[b]?disconnectStatus[b]:b)},c.prototype.writeMessage=function(a){var b=this.binaryHelper.convertStream(a);if(b.write(0),!(+status>=1&&+status<=3))throw new Error("Unsupported CONNACK code:"+status);b.write(+status-1)},c.prototype.setStatus=function(a){this.status=a},c.prototype.getStatus=function(){return this.status},c}(b);a.DisconnectMessage=e;var f=function(b){function c(c){b.call(this,c&&c instanceof a.Header?c:a.Type.PINGREQ),this._name="PingReqMessage"}return __extends(c,b),c}(b);a.PingReqMessage=f;var g=function(b){function c(c){b.call(this,c&&c instanceof a.Header?c:a.Type.PINGRESP),this._name="PingRespMessage"}return __extends(c,b),c}(b);a.PingRespMessage=g;var h=function(b){function c(c){b.call(this,c),this._name="RetryableMessage",this.binaryHelper=new a.BinaryHelper}return __extends(c,b),c.prototype.messageLength=function(){return 2},c.prototype.writeMessage=function(a){var b=this.binaryHelper.convertStream(a),c=this.getMessageId(),d=255&c,e=(65280&c)>>8;return b.write(e),b.write(d),b},c.prototype.readMessage=function(a,b){var c=256*a.read()+a.read();this.setMessageId(parseInt(c,10))},c.prototype.setMessageId=function(a){this.messageId=a},c.prototype.getMessageId=function(){return this.messageId},c}(b);a.RetryableMessage=h;var i=function(b){function c(c){b.call(this,c instanceof a.Header?c:a.Type.PUBACK),this.msgLen=2,this.date=0,this.millisecond=0,this.timestamp=0,this.binaryHelper=new a.BinaryHelper,this._name="PubAckMessage",c instanceof a.Header||b.prototype.setMessageId.call(this,c)}return __extends(c,b),c.prototype.messageLength=function(){return this.msgLen},c.prototype.writeMessage=function(a){var b=this.binaryHelper.convertStream(a);h.prototype.writeMessage.call(this,b)},c.prototype.readMessage=function(a,b){h.prototype.readMessage.call(this,a),this.date=a.readInt(),this.status=256*a.read()+a.read(),this.millisecond=256*a.read()+a.read(),this.timestamp=1e3*this.date+this.millisecond,this.messageUId=a.readUTF()},c.prototype.setStatus=function(a){this.status=a},c.prototype.setTimestamp=function(a){this.timestamp=a},c.prototype.setMessageUId=function(a){this.messageUId=a},c.prototype.getStatus=function(){return this.status},c.prototype.getDate=function(){return this.date},c.prototype.getTimestamp=function(){return this.timestamp},c.prototype.getMessageUId=function(){return this.messageUId},c}(h);a.PubAckMessage=i;var j=function(b){function c(c,d,e){b.call(this,1==arguments.length&&c instanceof a.Header?c:3==arguments.length?a.Type.PUBLISH:0),this._name="PublishMessage",this.binaryHelper=new a.BinaryHelper,3==arguments.length&&(this.topic=c,this.targetId=e,this.data="string"==typeof d?this.binaryHelper.toMQttString(d):d)}return __extends(c,b),c.prototype.messageLength=function(){var a=10;return a+=this.binaryHelper.toMQttString(this.topic).length,a+=this.binaryHelper.toMQttString(this.targetId).length,a+=this.data.length},c.prototype.writeMessage=function(a){var b=this.binaryHelper.convertStream(a);b.writeUTF(this.topic),b.writeUTF(this.targetId),h.prototype.writeMessage.apply(this,arguments),b.write(this.data)},c.prototype.readMessage=function(a,b){var c=6;this.date=a.readInt(),this.topic=a.readUTF(),c+=this.binaryHelper.toMQttString(this.topic).length,this.targetId=a.readUTF(),c+=this.binaryHelper.toMQttString(this.targetId).length,h.prototype.readMessage.apply(this,arguments),this.data=new Array(b-c),this.data=a.read(this.data)},c.prototype.setTopic=function(a){this.topic=a},c.prototype.setData=function(a){this.data=a},c.prototype.setTargetId=function(a){this.targetId=a},c.prototype.setDate=function(a){this.date=a},c.prototype.getTopic=function(){return this.topic},c.prototype.getData=function(){return this.data},c.prototype.getTargetId=function(){return this.targetId},c.prototype.getDate=function(){return this.date},c}(h);a.PublishMessage=j;var k=function(b){function c(c,d,e){b.call(this,c instanceof a.Header?c:3==arguments.length?a.Type.QUERY:null),this.binaryHelper=new a.BinaryHelper,this._name="QueryMessage",3==arguments.length&&(this.data="string"==typeof d?this.binaryHelper.toMQttString(d):d,this.topic=c,this.targetId=e)}return __extends(c,b),c.prototype.messageLength=function(){var a=0;return a+=this.binaryHelper.toMQttString(this.topic).length,a+=this.binaryHelper.toMQttString(this.targetId).length,a+=2,a+=this.data.length},c.prototype.writeMessage=function(a){var b=this.binaryHelper.convertStream(a);b.writeUTF(this.topic),b.writeUTF(this.targetId),h.prototype.writeMessage.call(this,b),b.write(this.data)},c.prototype.readMessage=function(a,b){var c=0;this.topic=a.readUTF(),this.targetId=a.readUTF(),c+=this.binaryHelper.toMQttString(this.topic).length,c+=this.binaryHelper.toMQttString(this.targetId).length,this.readMessage.apply(this,arguments),c+=2,this.data=new Array(b-c),a.read(this.data)},c.prototype.setTopic=function(a){this.topic=a},c.prototype.setData=function(a){this.data=a},c.prototype.setTargetId=function(a){this.targetId=a},c.prototype.getTopic=function(){return this.topic},c.prototype.getData=function(){return this.data},c.prototype.getTargetId=function(){return this.targetId},c}(h);a.QueryMessage=k;var l=function(b){function c(c){b.call(this,c instanceof a.Header?c:a.Type.QUERYCON),this._name="QueryConMessage",c instanceof a.Header||b.prototype.setMessageId.call(this,c)}return __extends(c,b),c}(h);a.QueryConMessage=l;var m=function(b){function c(c){b.call(this,c),this._name="QueryAckMessage",this.binaryHelper=new a.BinaryHelper}return __extends(c,b),c.prototype.readMessage=function(a,b){h.prototype.readMessage.call(this,a),this.date=a.readInt(),this.setStatus(256*a.read()+a.read()),b>0&&(this.data=new Array(b-8),this.data=a.read(this.data))},c.prototype.getData=function(){return this.data},c.prototype.getStatus=function(){return this.status},c.prototype.getDate=function(){return this.date},c.prototype.setDate=function(a){this.date=a},c.prototype.setStatus=function(a){this.status=a},c.prototype.setData=function(a){this.data=a},c}(h);a.QueryAckMessage=m}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(b){var c=new a.BinaryHelper;this.out=c.convertStream(b)}return b.prototype.writeMessage=function(b){b instanceof a.BaseMessage&&b.write(this.out)},b}();a.MessageOutputStream=b;var c=function(){function b(b,c){if(c)this.flags=b.headerCode;else{var d=(new a.BinaryHelper).convertStream(b);this.flags=d.readByte(),this._in=d}this.header=new a.Header(this.flags),this.isPolling=c,this.In=b}return b.prototype.readMessage=function(){switch(this.header.getType()){case 1:this.msg=new a.ConnectMessage(this.header);break;case 2:this.msg=new a.ConnAckMessage(this.header);break;case 3:this.msg=new a.PublishMessage(this.header);break;case 4:this.msg=new a.PubAckMessage(this.header);break;case 5:this.msg=new a.QueryMessage(this.header);break;case 6:this.msg=new a.QueryAckMessage(this.header);break;case 7:this.msg=new a.QueryConMessage(this.header);break;case 9:case 11:case 13:this.msg=new a.PingRespMessage(this.header);break;case 8:case 10:case 12:this.msg=new a.PingReqMessage(this.header);break;case 14:this.msg=new a.DisconnectMessage(this.header);break;default:throw new Error("No support for deserializing "+this.header.getType()+" messages")}return this.isPolling?this.msg.init(this.In):this.msg.read(this._in,this.In.length-1),this.msg},b}();a.MessageInputStream=c;var d=function(){function b(b,c,d,e){this.retain=!1,this.qos=a.Qos.AT_LEAST_ONCE,this.dup=!1,b&&+b==b&&1==arguments.length?(this.retain=(1&b)>0,this.qos=(6&b)>>1,this.dup=(8&b)>0,this.type=b>>4&15):(this.type=b,this.retain=c,this.qos=d,this.dup=e)}return b.prototype.getType=function(){return this.type},b.prototype.encode=function(){var b=this;switch(this.qos){case a.Qos[0]:b.qos=a.Qos.AT_MOST_ONCE;break;case a.Qos[1]:b.qos=a.Qos.AT_LEAST_ONCE;break;case a.Qos[2]:b.qos=a.Qos.EXACTLY_ONCE;break;case a.Qos[3]:b.qos=a.Qos.DEFAULT}var c=this.type<<4;return c|=this.retain?1:0,c|=this.qos<<1,c|=this.dup?8:0},b.prototype.toString=function(){return"Header [type="+this.type+",retain="+this.retain+",qos="+this.qos+",dup="+this.dup+"]"},b}();a.Header=d;var e=function(){function a(){}return a.prototype.writeUTF=function(a,b){for(var c=[],d=0,e=0,f=a.length;f>e;e++){var g=a.charCodeAt(e);g>=0&&127>=g?(d+=1,c.push(g)):g>=128&&2047>=g?(d+=2,c.push(192|31&g>>6),c.push(128|63&g)):g>=2048&&65535>=g&&(d+=3,c.push(224|15&g>>12),c.push(128|63&g>>6),c.push(128|63&g))}for(var e=0,f=c.length;f>e;e++)c[e]>255&&(c[e]&=255);return b?c:255>=d?[0,d].concat(c):[d>>8,255&d].concat(c)},a.prototype.readUTF=function(a){if("[object String]"==Object.prototype.toString.call(a))return a;for(var b="",c=a,d=0,e=c.length;e>d;d++){c[d]<0&&(c[d]+=256);var f=c[d].toString(2),g=f.match(/^1+?(?=0)/);if(g&&8==f.length){for(var h=g[0].length,i=c[d].toString(2).slice(7-h),j=1;h>j;j++)i+=c[j+d].toString(2).slice(2);b+=String.fromCharCode(parseInt(i,2)),d+=h-1}else b+=String.fromCharCode(c[d])}return b},a.prototype.convertStream=function(a){return a instanceof f?a:new f(a)},a.prototype.toMQttString=function(a){return this.writeUTF(a)},a}();a.BinaryHelper=e;var f=function(){function a(a){this.position=0,this.writen=0,this.poolLen=0,this.binaryHelper=new e,this.pool=a,this.poolLen=a.length}return a.prototype.check=function(){return this.position>=this.pool.length},a.prototype.readInt=function(){if(this.check())return-1;for(var a="",b=0;4>b;b++){var c=this.pool[this.position++].toString(16);1==c.length&&b>1&&(c="0"+c),a+=c.toString(16)}return parseInt(a,16)},a.prototype.readLong=function(){if(this.check())return-1;for(var a="",b=0;8>b;b++){var c=this.pool[this.position++].toString(16);1==c.length&&b>1&&(c="0"+c),a+=c}return parseInt(a,16)},a.prototype.readTimestamp=function(){if(this.check())return-1;for(var a="",b=0;8>b;b++)a+=this.pool[this.position++].toString(16);return a=a.substring(2,8),parseInt(a,16)},a.prototype.readUTF=function(){if(this.check())return-1;var a=this.readByte()<<8|this.readByte();return this.binaryHelper.readUTF(this.pool.subarray(this.position,this.position+=a))},a.prototype.readByte=function(){if(this.check())return-1;var a=this.pool[this.position++];return a>255&&(a&=255),a},a.prototype.read=function(a){return a?this.pool.subarray(this.position,this.poolLen):this.readByte()},a.prototype.write=function(a){var b=a;return"[object array]"==Object.prototype.toString.call(b).toLowerCase()?[].push.apply(this.pool,b):+b==b&&(b>255&&(b&=255),this.pool.push(b),this.writen++),b},a.prototype.writeChar=function(a){if(+a!=a)throw new Error("writeChar:arguments type is error");this.write(a>>8&255),this.write(255&a),this.writen+=2},a.prototype.writeUTF=function(a){var b=this.binaryHelper.writeUTF(a);[].push.apply(this.pool,b),this.writen+=b.length},a.prototype.toComplements=function(){for(var a=this.pool,b=0;b<this.poolLen;b++)a[b]>128&&(a[b]-=256);return a},a.prototype.getBytesArray=function(a){return a?this.toComplements():this.pool},a}();a.RongIMStream=f}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(a){return this.connected=!1,this.isClose=!1,this.queue=[],this.empty=new Function,this._socket=a,this}return b.prototype.createTransport=function(b,c){if(!b)throw new Error("URL can't be empty");return this.url=b,this.socket=new WebSocket(a.MessageUtil.schemeArrs[a.RongIMClient.schemeType][1]+"://"+b),this.socket.binaryType="arraybuffer",this.addEvent(),this.socket},b.prototype.send=function(b){if(!this.connected&&!this.isClose)return void this.queue.push(b);if(this.isClose)throw new Error("The Connection is closed,Please open the Connection!!!");var c=new a.RongIMStream([]),d=new a.MessageOutputStream(c);d.writeMessage(b);var e=c.getBytesArray(!0),f=new Int8Array(e);return this.socket.send(f.buffer),this},b.prototype.onData=function(b){return a.MessageUtil.isArray(b)?this._socket.onMessage(new a.MessageInputStream(b).readMessage()):this._socket.onMessage(new a.MessageInputStream(a.MessageUtil.ArrayFormInput(b)).readMessage()),""},b.prototype.onClose=function(){this.isClose=!0,this.socket=this.empty,this._socket.disconnect(a.ConnectionStatus.DISCONNECTED)},b.prototype.onError=function(a){throw new Error(a)},b.prototype.addEvent=function(){var a=this;a.socket.onopen=function(){a.connected=!0,a.isClose=!1,a.doQueue(),a._socket.fire("connect")},a.socket.onmessage=function(b){"string"==typeof b.data?a.onData(b.data.split(",")):a.onData(b.data)},a.socket.onerror=function(b){a.onError(b)},a.socket.onclose=function(){a.onClose()}},b.prototype.doQueue=function(){for(var a=this,b=0,c=a.queue.length;c>b;b++)a.send(a.queue[b])},b.prototype.disconnect=function(){this.socket.readyState&&(this.isClose=!0,this.socket.close())},b.prototype.reconnect=function(){this.disconnect(),this.createTransport(this.url)},b}();a.SocketTransportation=b}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(a){return this.empty=new Function,this.connected=!1,this.queue=[],this.socket=a,this}return b.prototype.createTransport=function(b,c){if(!b)throw new Error("Url is empty,Please check it!");this.url=b;var d=a.RongIMClient._cookieHelper.getItem(a.Navigation.Endpoint.userId+"sId"),e=this;return d?(setTimeout(function(){e.onSuccess('{"status":0,"userId":"'+a.Navigation.Endpoint.userId+'","headerCode":32,"messageId":0,"sessionid":"'+d+'"}'),e.connected=!0},500),this):(this.getRequest(b,!0),this)},b.prototype.requestFactory=function(b,c,d){var e=this.XmlHttpRequest();return d&&(e.multipart=!0),e.open(c||"GET",a.MessageUtil.schemeArrs[a.RongIMClient.schemeType][0]+"://"+b),"POST"==c&&"setRequestHeader"in e&&e.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8"),e},b.prototype.getRequest=function(a,b){var c=this;c.xhr=this.requestFactory(a,"GET"),"onload"in c.xhr?(c.xhr.onload=function(){c.xhr.onload=c.empty,"lost params"==this.responseText?c.onError():c.onSuccess(this.responseText,b)},c.xhr.onerror=function(){c.disconnect()}):c.xhr.onreadystatechange=function(){4==c.xhr.readyState&&(c.xhr.onreadystatechange=c.empty,/^(200|202)$/.test(c.xhr.status)?c.onSuccess(c.xhr.responseText,b):/^(400|403)$/.test(c.xhr.status)?c.onError():c.disconnect())},c.xhr.send()},b.prototype.send=function(b){var c=this;this.sendxhr=this.requestFactory(a.Navigation.Endpoint.host+"/websocket"+b.url,"POST"),"onload"in c.sendxhr?(c.sendxhr.onload=function(){c.sendxhr.onload=c.empty,c.onData(c.sendxhr.responseText)},c.sendxhr.onerror=function(){c.sendxhr.onerror=c.empty}):c.sendxhr.onreadystatechange=function(){4==c.sendxhr.readyState&&(this.onreadystatechange=this.empty,/^(202|200)$/.test(c.sendxhr.status)&&c.onData(c.sendxhr.responseText))},c.sendxhr.send(JSON.stringify(b.data))},b.prototype.onData=function(b,c){if(b&&"lost params"!=b){var d=this,e=JSON.parse(b);return e.userId&&(a.Navigation.Endpoint.userId=e.userId),c&&a.RongIMClient._cookieHelper.setItem(a.Navigation.Endpoint.userId+"sId",c),a.MessageUtil.isArray(e)||(e=[e]),Array.forEach(e,function(b){d.socket.fire("message",new a.MessageInputStream(b,!0).readMessage())}),""}},b.prototype.XmlHttpRequest=function(){var a="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;return"undefined"!=typeof XMLHttpRequest&&a?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:new ActiveXObject("Microsoft.XMLHTTP")},b.prototype.onClose=function(){this.xhr&&(this.xhr.onload?this.xhr.onreadystatechange=this.xhr.onload=this.empty:this.xhr.onreadystatechange=this.empty,this.xhr.abort(),this.xhr=null),this.sendxhr&&(this.sendxhr.onload?this.sendxhr.onreadystatechange=this.sendxhr.onload=this.empty:this.sendxhr.onreadystatechange=this.empty,this.sendxhr.abort(),this.sendxhr=null)},b.prototype.disconnect=function(){a.RongIMClient._cookieHelper.removeItem(a.Navigation.Endpoint.userId+"sId"),this.onClose()},b.prototype.reconnect=function(){this.disconnect(),this.createTransport(this.url)},b.prototype.onSuccess=function(b,c){var d=b.match(/"sessionid":"\S+?(?=")/);return this.onData(b,d?d[0].slice(13):0),/"headerCode":-32,/.test(b)?void a.RongIMClient._cookieHelper.removeItem(a.Navigation.Endpoint.userId+"sId"):(this.getRequest(a.Navigation.Endpoint.host+"/pullmsg.js?sessionid="+a.RongIMClient._cookieHelper.getItem(a.Navigation.Endpoint.userId+"sId")),this.connected=!0,void(c&&this.socket.fire("connect")))},b.prototype.onError=function(){a.RongIMClient._cookieHelper.removeItem(a.Navigation.Endpoint.userId+"sId"),this.onClose(),this.connected=!1,this.socket.fire("disconnect")},b}();a.PollingTransportation=b}(RongIMLib||(RongIMLib={}));var typeMapping={"RC:TxtMsg":"TextMessage","RC:ImgMsg":"ImageMessage","RC:VcMsg":"VoiceMessage","RC:ImgTextMsg":"RichContentMessage","RC:LBSMsg":"LocationMessage","RC:InfoNtf":"InformationNotificationMessage","RC:ContactNtf":"ContactNotificationMessage","RC:ProfileNtf":"ProfileNotificationMessage","RC:CmdNtf":"CommandNotificationMessage","RC:DizNtf":"DiscussionNotificationMessage","RC:CmdMsg":"CommandMessage"},registerMessageTypeMapping={},HistoryMsgType={4:"qryCMsg",2:"qryDMsg",3:"qryGMsg",1:"qryPMsg",6:"qrySMsg",7:"qryPMsg",8:"qryPMsg"},disconnectStatus={1:6},RongIMLib;!function(RongIMLib){var Transportations=function(){function a(){}return a._TransportType=RongIMLib.Socket.WEBSOCKET,a}();RongIMLib.Transportations=Transportations;var PublicServiceMap=function(){function a(){this.publicServiceList=[]}return a.prototype.get=function(a,b){for(var c=0,d=this.publicServiceList.length;d>c;c++)if(this.publicServiceList[c].conversationType==a&&b==this.publicServiceList[c].publicServiceId)return this.publicServiceList[c]},a.prototype.add=function(a){for(var b=!0,c=this,d=0,e=this.publicServiceList.length;e>d;d++)if(c.publicServiceList[d].conversationType==a.conversationType&&a.publicServiceId==c.publicServiceList[d].publicServiceId){this.publicServiceList.unshift(this.publicServiceList.splice(d,1)[0]),b=!1;break}b&&this.publicServiceList.unshift(a)},a.prototype.replace=function(a){for(var b=this,c=0,d=this.publicServiceList.length;d>c;c++)if(b.publicServiceList[c].conversationType==a.conversationType&&a.publicServiceId==b.publicServiceList[c].publicServiceId){b.publicServiceList.splice(c,1,a);break}},a.prototype.remove=function(a,b){for(var c=this,d=0,e=this.publicServiceList.length;e>d;d++)if(c.publicServiceList[d].conversationType==a&&b==c.publicServiceList[d].publicServiceId){this.publicServiceList.splice(d,1);break}},a}();RongIMLib.PublicServiceMap=PublicServiceMap;var ConversationMap=function(){function a(){this.conversationList=[]}return a.prototype.get=function(a,b){for(var c=0,d=this.conversationList.length;d>c;c++)if(this.conversationList[c].conversationType==a&&this.conversationList[c].targetId==b)return this.conversationList[c];return null},a.prototype.add=function(a){for(var b=!0,c=0,d=this.conversationList.length;d>c;c++)if(this.conversationList[c].conversationType===a.conversationType&&this.conversationList[c].targetId===a.targetId){this.conversationList.unshift(this.conversationList.splice(c,1)[0]),b=!1;break}b&&this.conversationList.unshift(a)},a.prototype.replace=function(a){for(var b=0,c=this.conversationList.length;c>b;b++)if(this.conversationList[b].conversationType===a.conversationType&&this.conversationList[b].targetId===a.targetId){this.conversationList.splice(b,1,a);break}},a.prototype.remove=function(a){for(var b=0,c=this.conversationList.length;c>b;b++)if(this.conversationList[b].conversationType===a.conversationType&&this.conversationList[b].targetId===a.targetId){this.conversationList.splice(b,1);break}},a}();RongIMLib.ConversationMap=ConversationMap;var MessageUtil=function(){function MessageUtil(){}return MessageUtil.supportLargeStorage=function(){return!!window.localStorage},MessageUtil.checkStorageSize=function(){return JSON.stringify(localStorage).length<468e4},MessageUtil.ArrayForm=function(a){if("[object ArrayBuffer]"==Object.prototype.toString.call(a)){var b=new Int8Array(a);return[].slice.call(b)}return a},MessageUtil.ArrayFormInput=function(a){if("[object ArrayBuffer]"==Object.prototype.toString.call(a)){var b=new Uint8Array(a);return b}return a},MessageUtil.indexOf=function(a,b,c){for(var d=a.length,e=0>c?Math.max(0,+c):c||0;d>e;e++)if(a[e]==b)return e;return-1},MessageUtil.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)},MessageUtil.forEach=function(a,b){return[].forEach?function(a,b){[].forEach.call(a,b)}:function(a,b){for(var c=0;c<a.length;c++)b.call(a,a[c],c,a)}},MessageUtil.remove=function(a,b){for(var c=0,d=a.length;d>c;c++)if(b(a[c]))return a.splice(c,1)[0];return null},MessageUtil.int64ToTimestamp=function(a,b){if(void 0===a.low)return a;var c=a.low;0>c&&(c+=4294967296),c=c.toString(16);var d=parseInt(a.high.toString(16)+"00000000".replace(new RegExp("0{"+c.length+"}$"),c),16);return b?new Date(d):d},MessageUtil.messageParser=function(entity,onReceived){var message=new RongIMLib.Message,content=entity.content,de,objectName=entity.classname,val,isUseDef=!1;try{RongIMLib.RongIMClient._memoryStore.global.WEB_XHR_POLLING?(val=(new RongIMLib.BinaryHelper).readUTF(content.offset?MessageUtil.ArrayForm(content.buffer).slice(content.offset,content.limit):content),de=JSON.parse(val)):(val=(new RongIMLib.BinaryHelper).readUTF(content.offset?MessageUtil.ArrayFormInput(content.buffer).subarray(content.offset,content.limit):content),de=JSON.parse(val))}catch(ex){de=val,isUseDef=!0}if("Expression"in RongIMLib&&de.content&&(de.content=de.content.replace(/[\uf000-\uf700]/g,function(x){return eval("RongIMLib.Expression.calcUTF(x) || x")})),objectName in typeMapping){var str="new RongIMLib."+typeMapping[objectName]+"(de)";message.content=eval(str),message.messageType=typeMapping[objectName]}else if(objectName in registerMessageTypeMapping){var str="new RongIMLib.RongIMClient.RegisterMessage."+registerMessageTypeMapping[objectName]+"(de)";isUseDef?message.content=eval(str).decode(de):message.content=eval(str),message.messageType=registerMessageTypeMapping[objectName]}else message.content=new RongIMLib.UnknownMessage({content:de,objectName:objectName}),message.messageType="UnknownMessage";return message.sentTime=MessageUtil.int64ToTimestamp(entity.dataTime),message.senderUserId=entity.fromUserId,message.conversationType=entity.type,entity.fromUserId==RongIMLib.Bridge._client.userId?message.targetId=entity.groupId:message.targetId=/^[234]$/.test(entity.type||entity.getType())?entity.groupId:message.senderUserId,1==entity.direction?message.messageDirection=RongIMLib.MessageDirection.SEND:message.messageDirection=RongIMLib.MessageDirection.RECEIVE,2==(2&entity.status)&&(message.hasReceivedByOtherClient=!0),message.messageUId=entity.msgId,message.receivedTime=(new Date).getTime(),message.messageId=message.conversationType+"_"+~~(16777215*Math.random()),message.objectName=objectName,message},MessageUtil.schemeArrs=[["http","ws"],["https","wss"]],MessageUtil.sign={converNum:1,msgNum:1,isMsgStart:!0,isConvStart:!0},MessageUtil}();RongIMLib.MessageUtil=MessageUtil;var MessageIdHandler=function(){function a(){}return a.init=function(){this.messageId=+(RongIMLib.RongIMClient._cookieHelper.getItem("msgId")||RongIMLib.RongIMClient._cookieHelper.setItem("msgId",0)||0)},a.messageIdPlus=function(a){return this.isXHR&&this.init(),this.messageId>=65535?(a(),!1):(this.messageId++,this.isXHR&&RongIMLib.RongIMClient._cookieHelper.setItem("msgId",this.messageId),this.messageId)},a.clearMessageId=function(){this.messageId=0,this.isXHR&&RongIMLib.RongIMClient._cookieHelper.setItem("msgId",this.messageId)},a.getMessageId=function(){return this.isXHR&&this.init(),this.messageId},a.messageId=0,a.isXHR=Transportations._TransportType===RongIMLib.Socket.XHR_POLLING,a}();RongIMLib.MessageIdHandler=MessageIdHandler;var CheckParam=function(){function a(){}return a.getInstance=function(){return new a},a.prototype.check=function(a,b,c){var d=arguments.callee.caller;if(!("_client"in RongIMLib.Bridge||c))throw new Error("The parameter is incorrect or was not yet instantiated RongIMClient -> position:"+b);for(var e=0,f=d.arguments.length;f>e;e++)if(!new RegExp(this.getType(d.arguments[e])).test(a[e]))throw new Error("The index of "+e+" parameter was wrong type "+this.getType(d.arguments[e])+" ["+a[e]+"] -> position:"+b)},a.prototype.getType=function(a){var b=Object.prototype.toString.call(a).toLowerCase();return b.slice(8,b.length-1)},a}();RongIMLib.CheckParam=CheckParam;var LimitableMap=function(){function a(a){this.map={},this.keys=[],this.limit=a||10}return a.prototype.set=function(a,b){if(this.map.hasOwnProperty(a)){if(this.keys.length===this.limit){var c=this.keys.shift();delete this.map[c]}this.keys.push(a)}this.map[a]=b},a.prototype.get=function(a){return this.map[a]||0},a.prototype.remove=function(a){delete this.map[a]},a}();RongIMLib.LimitableMap=LimitableMap}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function a(a){throw new Error("This method is abstract, you must implement this method in inherited class.")}return a.obtain=function(){throw new Error("This method is abstract, you must implement this method in inherited class.")},a}();a.MessageContent=b;var c=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(b);a.NotificationMessage=c;var d=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(b);a.StatusMessage=d;var e=function(){function b(){}return b.modelClone=function(a){var b={};for(var c in a)"messageName"!=c&&"encode"!=c&&(b[c]=a[c]);return b},b.modleCreate=function(b){if(b.length<1)throw new Error("Array is empty  -> registerMessageType.modleCreate");var c=function(d){for(var e in b)d[b[e]]&&(c.prototype[b[e]]=d[b[e]]);this.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))}};return c},b}();a.ModelUtil=e}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function a(a){this.messageName="IsTypingStatusMessage"}return a.prototype.encode=function(){},a.prototype.getMessage=function(){return null},a}();a.IsTypingStatusMessage=b;var c=function(){function a(a){this.messageName="HandshakeMessage"}return a.prototype.encode=function(){},a.prototype.getMessage=function(){return null},a}();a.HandshakeMessage=c;var d=function(){function a(a){this.messageName="SuspendMessage"}return a.prototype.encode=function(){},a.prototype.getMessage=function(){return null},a}();a.SuspendMessage=d}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(a){if(this.messageName="InformationNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> InformationNotificationMessage.");
this.message=a.message,this.extra=a.extra,a.userInfo&&(this.userInfo=a.userInfo)}return b.obtain=function(a){return new b({message:a,extra:""})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.InformationNotificationMessage=b;var c=function(){function b(a){if(this.messageName="CommandMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> CommandMessage.");try{"[object String]"==Object.prototype.toString.call(a.data)?this.data=JSON.parse(a.data):this.data=a.data}catch(b){this.data=a.data}this.name=a.name,this.extra=a.extra}return b.obtain=function(a){return new b({data:a,extra:""})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.CommandMessage=c;var d=function(){function c(a){if(this.messageName="ContactNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ContactNotificationMessage.");this.operation=a.operation,this.targetUserId=a.targetUserId,this.message=a.message,this.extra=a.extra,this.sourceUserId=a.sourceUserId,a.userInfo&&(this.userInfo=a.userInfo)}return c.obtain=function(a,c,d,e){return new b({operation:a,sourceUserId:c,targetUserId:d,message:e})},c.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},c.CONTACT_OPERATION_ACCEPT_RESPONSE="ContactOperationAcceptResponse",c.CONTACT_OPERATION_REJECT_RESPONSE="ContactOperationRejectResponse",c.CONTACT_OPERATION_REQUEST="ContactOperationRequest",c}();a.ContactNotificationMessage=d;var e=function(){function b(a){if(this.messageName="ProfileNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ProfileNotificationMessage.");this.operation=a.operation;try{"[object String]"==Object.prototype.toString.call(a.data)?this.data=JSON.parse(a.data):this.data=a.data}catch(b){this.data=a.data}this.extra=a.extra,a.userInfo&&(this.userInfo=a.userInfo)}return b.obtain=function(a,c){return new b({operation:a,data:c})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.ProfileNotificationMessage=e;var f=function(){function b(a){if(this.messageName="CommandNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ProfileNotificationMessage.");try{"[object String]"==Object.prototype.toString.call(a.data)?this.data=JSON.parse(a.data):this.data=a.data}catch(b){this.data=a.data}this.name=a.name,this.extra=a.extra,a.userInfo&&(this.userInfo=a.userInfo)}return b.obtain=function(a,c){return new b({name:a,data:c,extra:""})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.CommandNotificationMessage=f;var g=function(){function b(a){if(this.messageName="DiscussionNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> DiscussionNotificationMessage.");this.extra=a.extra,this.extension=a.extension,this.type=a.type,this.isHasReceived=a.isHasReceived,this.operation=a.operation,this.userInfo=a.userInfo,a.userInfo&&(this.userInfo=a.userInfo)}return b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.DiscussionNotificationMessage=g}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(a){if(this.messageName="TextMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> TextMessage.");this.content=a.content,this.extra=a.extra,a.userInfo&&(this.userInfo=a.userInfo)}return b.obtain=function(a){return new b({extra:"",content:a})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.TextMessage=b;var c=function(){function b(a){if(this.messageName="VoiceMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> VoiceMessage.");this.content=a.content,this.duration=a.duration,this.extra=a.extra,a.userInfo&&(this.userInfo=a.userInfo)}return b.obtain=function(a,c){return new b({content:a,duration:c,extra:""})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.VoiceMessage=c;var d=function(){function b(a){if(this.messageName="ImageMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ImageMessage.");this.content=a.content,this.imageUri=a.imageUri,this.extra=a.extra,a.userInfo&&(this.userInfo=a.userInfo)}return b.obtain=function(a,c){return new b({content:a,imageUri:c,extra:""})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.ImageMessage=d;var e=function(){function b(a){if(this.messageName="LocationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> LocationMessage.");this.latiude=a.latitude,this.longitude=a.longitude,this.poi=a.poi,this.content=a.content,this.extra=a.extra,a.userInfo&&(this.userInfo=a.userInfo)}return b.obtain=function(a,c,d,e){return new b({latitude:c,longitude:c,poi:d,content:e,extra:""})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.LocationMessage=e;var f=function(){function b(a){if(this.messageName="RichContentMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> RichContentMessage.");this.title=a.title,this.content=a.content,this.imageUri=a.imageUri,this.extra=a.extra,a.userInfo&&(this.userInfo=a.userInfo)}return b.obtain=function(a,c,d){return new b({title:a,content:c,imageUri:d,extra:""})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.RichContentMessage=f;var g=function(){function a(a){if(this.messageName="UnknownMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> UnknownMessage.");this.message=a}return a.prototype.encode=function(){return""},a}();a.UnknownMessage=g;var h=function(){function b(a){if(this.messageName="PublicServiceCommandMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> PublicServiceCommandMessage.");this.content=a.content,this.extra=a.extra,this.menuItem=a.menuItem,a.userInfo&&(this.userInfo=a.userInfo)}return b.obtain=function(a){return new b({content:"",command:"",menuItem:a,extra:""})},b.prototype.encode=function(){return JSON.stringify(a.ModelUtil.modelClone(this))},b}();a.PublicServiceCommandMessage=h;var i=function(){function a(a){this.messageName="PublicServiceMultiRichContentMessage",this.richContentMessages=a}return a.prototype.encode=function(){return null},a}();a.PublicServiceMultiRichContentMessage=i;var j=function(){function a(a){this.messageName="PublicServiceRichContentMessage",this.richContentMessage=a}return a.prototype.encode=function(){return null},a}();a.PublicServiceRichContentMessage=j}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){this.conversationTitle=a,this.conversationType=b,this.draft=c,this.isTop=d,this.latestMessage=e,this.latestMessageId=f,this.notificationStatus=g,this.objectName=h,this.receivedStatus=i,this.receivedTime=j,this.senderUserId=k,this.senderUserName=l,this.sentStatus=m,this.sentTime=n,this.targetId=o,this.unreadMessageCount=p,this.senderPortraitUri=q}return b.prototype.setTop=function(){a.RongIMClient._dataAccessProvider.addConversation(this,{onSuccess:function(a){}})},b}();a.Conversation=b;var c=function(){function a(a,b,c,d,e){this.creatorId=a,this.id=b,this.memberIdList=c,this.name=d,this.isOpen=e}return a}();a.Discussion=c;var d=function(){function a(a,b,c){this.id=a,this.name=b,this.portraitUri=c}return a}();a.Group=d;var e=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){this.content=a,this.conversationType=b,this.extra=c,this.objectName=d,this.messageDirection=e,this.messageId=f,this.receivedStatus=g,this.receivedTime=h,this.senderUserId=i,this.sentStatus=j,this.sentTime=k,this.targetId=l,this.messageType=m,this.messageUId=n,this.hasReceivedByOtherClient=o}return a}();a.Message=e;var f=function(){function a(a,b){this.isCounted=a,this.isPersited=b}return a.prototype.getMessageTag=function(){return this.isCounted&&this.isPersited?3:this.isCounted||!this.isPersited?2:!this.isCounted||this.isPersited?1:this.isCounted||this.isPersited?void 0:0},a}();a.MessageTag=f;var g=function(){function a(a,b,c,d,e){this.id=a,this.name=b,this.type=c,this.sunMenuItems=d,this.url=e}return a}();a.PublicServiceMenuItem=g;var h=function(){function a(a,b,c,d,e,f,g,h){this.conversationType=a,this.introduction=b,this.menu=c,this.name=d,this.portraitUri=e,this.publicServiceId=f,this.hasFollowed=g,this.isGlobal=h}return a}();a.PublicServiceProfile=h;var i=function(){function a(a,b,c){this.userId=a,this.name=b,this.portraitUri=c}return a}();a.UserInfo=i}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(){}return b.prototype.addConversation=function(b,c){for(var d=!0,e=0,f=a.RongIMClient._memoryStore.conversationList.length;f>e;e++)if(a.RongIMClient._memoryStore.conversationList[e].conversationType===b.conversationType&&a.RongIMClient._memoryStore.conversationList[e].targetId===b.targetId){a.RongIMClient._memoryStore.conversationList.unshift(a.RongIMClient._memoryStore.conversationList.splice(e,1)[0]),d=!1;break}d&&a.RongIMClient._memoryStore.conversationList.unshift(b),c.onSuccess(!0)},b.prototype.removeConversation=function(b,c,d){for(var e=0,f=a.RongIMClient._memoryStore.conversationList.length;f>e;e++)if(a.RongIMClient._memoryStore.conversationList[e].conversationType===b&&a.RongIMClient._memoryStore.conversationList[e].targetId===c){a.RongIMClient._memoryStore.conversationList.splice(e,1),a.MessageUtil.supportLargeStorage()&&a.LocalStorageProvider.getInstance().removeItem("cu"+a.Bridge._client.userId+b+c);break}d.onSuccess(!0)},b.prototype.addMessage=function(b,c,d,e){e&&e.onSuccess(new a.Message)},b.prototype.removeMessage=function(a,b,c,d){d.onSuccess(!0)},b.prototype.updateMessage=function(a,b){b.onSuccess(a)},b.prototype.clearMessages=function(a,b,c){c.onSuccess(!0)},b.prototype.updateMessages=function(b,c,d,e,f){var g=this;"readStatus"==d&&a.RongIMClient._memoryStore.conversationList.length>0&&g.getConversationList({onSuccess:function(a){Array.forEach(a,function(a){a.conversationType==b&&a.targetId==c&&(a.unreadMessageCount=0)})},onError:function(a){f.onError(a)}},null),f.onSuccess(!0)},b.prototype.getConversation=function(b,c){for(var d=null,e=0,f=a.RongIMClient._memoryStore.conversationList.length;f>e;e++)if(a.RongIMClient._memoryStore.conversationList[e].conversationType==b&&a.RongIMClient._memoryStore.conversationList[e].targetId==c&&(d=a.RongIMClient._memoryStore.conversationList[e],a.MessageUtil.supportLargeStorage())){var g=a.LocalStorageProvider.getInstance().getItem("cu"+a.Bridge._client.userId+b+c);0==d.unreadMessageCount&&(d.unreadMessageCount=Number(g))}return d},b.prototype.getConversationList=function(b,c){if(0==a.RongIMClient._memoryStore.conversationList.length||a.RongIMClient._memoryStore.isSyncRemoteConverList)a.RongIMClient.getInstance().getRemoteConversationList({onSuccess:function(c){a.MessageUtil.supportLargeStorage()&&Array.forEach(a.RongIMClient._memoryStore.conversationList,function(b){var c=a.LocalStorageProvider.getInstance().getItem("cu"+a.Bridge._client.userId+b.conversationType+b.targetId);0==b.unreadMessageCount&&(b.unreadMessageCount=Number(c))}),a.RongIMClient._memoryStore.isSyncRemoteConverList=!1,b.onSuccess(c)},onError:function(a){b.onSuccess([])}},c);else if(c){var d=[];Array.forEach(c,function(b){Array.forEach(a.RongIMClient._memoryStore.conversationList,function(a){a.conversationType==b&&d.push(a)})}),b.onSuccess(d)}else b.onSuccess(a.RongIMClient._memoryStore.conversationList)},b.prototype.clearConversations=function(b,c){Array.forEach(b,function(b){Array.forEach(a.RongIMClient._memoryStore.conversationList,function(c){b==c.conversationType&&a.RongIMClient.getInstance().removeConversation(c.conversationType,c.targetId,{onSuccess:function(){},onError:function(){}})})}),c.onSuccess(!0)},b.prototype.getHistoryMessages=function(b,c,d,e,f){a.RongIMClient.getInstance().getRemoteHistoryMessages(b,c,d,e,f)},b.prototype.getTotalUnreadCount=function(b){var c=0;Array.forEach(a.RongIMClient._memoryStore.conversationList,function(a){c+=a.unreadMessageCount}),b.onSuccess(c)},b.prototype.getConversationUnreadCount=function(b,c){var d=0;Array.forEach(b,function(b){Array.forEach(a.RongIMClient._memoryStore.conversationList,function(a){a.conversationType==b&&(d+=a.unreadMessageCount)})}),c.onSuccess(d)},b.prototype.getUnreadCount=function(a,b,c){var d=this.getConversation(a,b);c.onSuccess(d?d.unreadMessageCount:0)},b.prototype.clearUnreadCount=function(b,c,d){var e=this.getConversation(b,c);e&&(a.MessageUtil.supportLargeStorage()&&a.LocalStorageProvider.getInstance().removeItem("cu"+a.Bridge._client.userId+b+c),e.unreadMessageCount=0),d.onSuccess(!0)},b.prototype.setConversationToTop=function(a,b,c){var d=this.getConversation(a,b);this.addConversation(d,c)},b.prototype.setMessageExtra=function(a,b,c){c.onSuccess(!0)},b.prototype.setMessageReceivedStatus=function(a,b,c){c.onSuccess(!0)},b.prototype.setMessageSentStatus=function(a,b,c){c.onSuccess(!0)},b}();a.ServerDataProvider=b}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function a(){}return a.prototype.addConversation=function(a,b){throw new Error("Not implemented yet")},a.prototype.removeConversation=function(a,b,c){throw new Error("Not implemented yet")},a.prototype.addMessage=function(a,b,c,d){throw new Error("Not implemented yet")},a.prototype.removeMessage=function(a,b,c,d){throw new Error("Not implemented yet")},a.prototype.updateMessage=function(a,b){throw new Error("Not implemented yet")},a.prototype.clearMessages=function(a,b,c){throw new Error("Not implemented yet")},a.prototype.updateMessages=function(a,b,c,d,e){throw new Error("Not implemented yet")},a.prototype.getConversation=function(a,b){throw new Error("Not implemented yet")},a.prototype.getConversationList=function(a,b){throw new Error("Not implemented yet")},a.prototype.clearConversations=function(a,b){throw new Error("Not implemented yet")},a.prototype.getHistoryMessages=function(a,b,c,d,e){throw new Error("Not implemented yet")},a.prototype.getTotalUnreadCount=function(a){throw new Error("Not implemented yet")},a.prototype.getConversationUnreadCount=function(a,b){throw new Error("Not implemented yet")},a.prototype.getUnreadCount=function(a,b,c){throw new Error("Not implemented yet")},a.prototype.clearUnreadCount=function(a,b,c){throw new Error("Not implemented yet")},a.prototype.setConversationToTop=function(a,b,c){throw new Error("Not implemented yet")},a.prototype.setMessageExtra=function(a,b,c){throw new Error("Not implemented yet")},a.prototype.setMessageReceivedStatus=function(a,b,c){throw new Error("Not implemented yet")},a.prototype.setMessageSentStatus=function(a,b,c){throw new Error("Not implemented yet")},a}();a.WebSQLDataProvider=b}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function a(){}return a.prototype.setItem=function(a,b){var c=new Date;c.setTime(c.getTime()+1296e6),document.cookie=a+"="+decodeURIComponent(b)+";path=/;expires="+c.toGMTString()},a.prototype.getItem=function(a){var b=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null!=b?b[2]:null},a.prototype.removeItem=function(a){this.getItem(a)&&(document.cookie=a+"=;path=/;expires=Thu, 01-Jan-1970 00:00:01 GMT")},a.prototype.getItemKey=function(a){var b=document.cookie.match(new RegExp("(^| )navi\\w+?=([^;]*)(;|$)")),c="";if(b)for(var d=0,e=b.length;e>d;d++)if(b[d].indexOf(a)>-1){c=b[d];break}return c?c.split("=")[0].replace(/^\s/,""):null},a.prototype.clearItem=function(){var a=document.cookie.match(/[^ =;]+(?=\=)/g);if(a)for(var b=a.length;b--;)document.cookie=a[b]+"=0;path=/;expires="+new Date(0).toUTCString()},a.prototype.onOutOfQuota=function(){return 4096},a}();a.CookieProvider=b}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function a(){}return a.getInstance=function(){return new a},a.prototype.setItem=function(a,b){20==localStorage.length&&localStorage.removeItem(localStorage.key(0)),localStorage.setItem(a.toString(),b)},a.prototype.getItem=function(a){return localStorage.getItem(a?a.toString():"")},a.prototype.removeItem=function(a){localStorage.removeItem(a.toString())},a.prototype.clearItem=function(){localStorage.clear()},a.prototype.onOutOfQuota=function(){return JSON.stringify(localStorage).length},a}();a.LocalStorageProvider=b}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){var b=function(){function b(){this.script=document.createElement("script"),this.head=document.getElementsByTagName("head")[0],a.Transportations._TransportType=a.Socket.WEBSOCKET,"WebSocket"in window&&"ArrayBuffer"in window&&3===WebSocket.prototype.CLOSED&&!window.WEB_XHR_POLLING?(this.script.src=a.MessageUtil.schemeArrs[a.RongIMClient.schemeType][0]+"://cdn.ronghub.com/protobuf-min-2.7.js",this.head.appendChild(this.script)):(a.Transportations._TransportType="xhr-polling",window.Modules=Polling)}return b}();a.FeatureDectector=b,"interactive"==document.readyState||"loading"==document.readyState||"complete"==document.readyState?new b:document.addEventListener?document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),new b},!1):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"interactive"!=document.readyState&&"loading"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",arguments.callee),new b)})}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(RongIMLib){var FeaturePatcher=function(){function FeaturePatcher(){}return FeaturePatcher.prototype.patchAll=function(){this.patchJSON(),this.patchForEach()},FeaturePatcher.prototype.patchForEach=function(){Array.forEach||(Array.forEach=function(a,b){for(var c=0;c<a.length;c++)b.call(a,a[c],c,a)})},FeaturePatcher.prototype.patchJSON=function(){window.JSON||(window.JSON=function(){function JSON(){}return JSON.parse=function(sJSON){return eval("("+sJSON+")")},JSON.stringify=function(a){var b=Object.prototype.toString,c=Array.isArray||function(a){return"[object Array]"===b.call(a)},d={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},e=function(a){return d[a]||"\\u"+(a.charCodeAt(0)+65536).toString(16).substr(1)},f=new RegExp('[\\"-]',"g");if(null==a)return"null";if("number"==typeof a)return isFinite(a)?a.toString():"null";if("boolean"==typeof a)return a.toString();if("object"==typeof a){if("function"==typeof a.toJSON)return window.JSON.stringify(a.toJSON());if(c(a)){for(var g="[",h=0,i=a.length;i>h;h++)g+=(h?", ":"")+window.JSON.stringify(a[h]);return g+"]"}if("[object Object]"===b.call(a)){var j=[];for(var k in a)a.hasOwnProperty(k)&&j.push(window.JSON.stringify(k)+": "+window.JSON.stringify(a[k]));return"{"+j.join(", ")+"}"}}return'"'+a.toString().replace(f,e)+'"'},JSON}())},FeaturePatcher}();RongIMLib.FeaturePatcher=FeaturePatcher}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(a){(function(){function a(){}return a.prototype.load=function(a,b,c){var d=document.createElement("script");d.async=!0,b&&(d.addEventListener?d.addEventListener("load",function(a){var c=a.target||a.srcElement;b(c.src)},!1):d.readyState&&(d.onreadystatechange=function(a){var c=a.srcElement;b(c.src)})),c&&(d.onerror=function(a){var b=a.target||a.srcElement;c(b.src)}),(document.head||document.getElementsByTagName("head")[0]).appendChild(d),d.src=a},a})()}(RongIMLib||(RongIMLib={}));
//# sourceMappingURL=RongIMLib.min.js.map